
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Evaluate and track LLM applications. Explain Deep Neural Nets.">
      
      
      
      
        <link rel="prev" href="../distributions/">
      
      
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.3">
    
    
      
        <title>Visualizations - TruLens</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.79e020e9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a5377069.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/cover.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="trulens" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#visualization-methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="TruLens" class="md-header__button md-logo" aria-label="TruLens" data-md-component="logo">
      
  <img src="../../../img/squid.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TruLens
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Visualizations
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/truera/trulens" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    truera/trulens
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../welcome/" class="md-tabs__link">
        
  
    
  
  Welcome to TruLens!

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../trulens_eval/install/" class="md-tabs__link">
          
  
    
  
  Eval

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../install/" class="md-tabs__link">
          
  
    
  
  Explain

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="TruLens" class="md-nav__button md-logo" aria-label="TruLens" data-md-component="logo">
      
  <img src="../../../img/squid.png" alt="logo">

    </a>
    TruLens
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/truera/trulens" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    truera/trulens
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to TruLens!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Eval
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Eval
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üöÄ Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚ö° Quickstarts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            ‚ö° Quickstarts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TruLens Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/langchain_quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Langchain Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/llama_index_quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama-Index Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/text2text_quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Text to Text Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/groundtruth_evals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground Truth Evaluations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/human_feedback/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Human Feedback Quickstart
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üß† Core Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            üß† Core Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/core_concepts_feedback_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feedback Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/core_concepts_rag_triad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RAG Triad
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/core_concepts_honest_harmless_helpful_evals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Honest, Harmless, Helpful Evals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üéØ Feedback Function Overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            üéØ Feedback Function Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/feedback_function_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is a Feedback Function?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/feedback_function_anatomy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anatomy of a Feedback Function
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üèÉ Running Feedback Functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            üèÉ Running Feedback Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/feedback_functions_running_with_app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running with your app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/feedback_functions_existing_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running on existing data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ü´µ Feedback Selectors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            ü´µ Feedback Selectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/feedback_selectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/selecting_components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Selecting Components
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/selector_shortcuts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Available shortcuts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üí™ Feedback Providers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            üí™ Feedback Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/openai_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenAI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/azureopenai_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AzureOpenAI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/bedrock_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Bedrock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/huggingface_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HuggingFace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/litellm_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LiteLLM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/langchain_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Langchain
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_5" >
        
          
          <label class="md-nav__link" for="__nav_3_2_5" id="__nav_3_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìö Feedback Implementations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_5">
            <span class="md-nav__icon md-icon"></span>
            üìö Feedback Implementations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/feedback/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stock Feedback Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/custom_feedback_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_6" >
        
          
          <label class="md-nav__link" for="__nav_3_2_6" id="__nav_3_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üé≤ Generating Test Cases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_6">
            <span class="md-nav__icon md-icon"></span>
            üé≤ Generating Test Cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/generate_test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generating Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_7" >
        
          
          <label class="md-nav__link" for="__nav_3_2_7" id="__nav_3_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚úÖ Feedback Evaluations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_7">
            <span class="md-nav__icon md-icon"></span>
            ‚úÖ Feedback Evaluations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/answer_relevance_smoke_tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Answer Relevance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/context_relevance_smoke_tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Context Relevance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/groundedness_smoke_tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Groundedness
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tracking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Tracking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üé∫ Instrumentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_1">
            <span class="md-nav__icon md-icon"></span>
            üé∫ Instrumentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/trulens_instrumentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/langchain_instrumentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LangChain Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/llama_index_instrumentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama-Index Integration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üöö Logging
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            üöö Logging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/where_to_log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Where to Log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging Methods
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìö API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            üìö API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/tru/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tru
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trubasicapp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TruBasicApp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/truchain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TruChain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trullama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TruLlama
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trucustom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TruCustom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/truvirtual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TruVirtual
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_1" >
        
          
          <label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üîç Use Cases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_1">
            <span class="md-nav__icon md-icon"></span>
            üîç Use Cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_any/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Any LLM App
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_rag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RAGs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLM Agents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_production/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev to Prod
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ü§ù Contribution Guidelines
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Explain
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Explain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üöÄ Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ‚ö° Quickstart
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../attribution_parameterization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attributions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../model_wrappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../slices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quantities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../distributions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Visualizations
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Visualizations
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations" class="md-nav__link">
    visualizations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer" class="md-nav__link">
    ChannelMaskVisualizer
  </a>
  
    <nav class="md-nav" aria-label="ChannelMaskVisualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__" class="md-nav__link">
    __call__()
  </a>
  
    <nav class="md-nav" aria-label="__call__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HTML" class="md-nav__link">
    HTML
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer" class="md-nav__link">
    HeatmapVisualizer
  </a>
  
    <nav class="md-nav" aria-label="HeatmapVisualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.IPython" class="md-nav__link">
    IPython
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.MaskVisualizer" class="md-nav__link">
    MaskVisualizer
  </a>
  
    <nav class="md-nav" aria-label="MaskVisualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.MaskVisualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.NLP" class="md-nav__link">
    NLP
  </a>
  
    <nav class="md-nav" aria-label="NLP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.NLP.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.NLP.token_attribution" class="md-nav__link">
    token_attribution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Output" class="md-nav__link">
    Output
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.PlainText" class="md-nav__link">
    PlainText
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Tiler" class="md-nav__link">
    Tiler
  </a>
  
    <nav class="md-nav" aria-label="Tiler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Tiler.tile" class="md-nav__link">
    tile()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Visualizer" class="md-nav__link">
    Visualizer
  </a>
  
    <nav class="md-nav" aria-label="Visualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Visualizer.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Visualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations" class="md-nav__link">
    visualizations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer" class="md-nav__link">
    ChannelMaskVisualizer
  </a>
  
    <nav class="md-nav" aria-label="ChannelMaskVisualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__" class="md-nav__link">
    __call__()
  </a>
  
    <nav class="md-nav" aria-label="__call__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HTML" class="md-nav__link">
    HTML
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer" class="md-nav__link">
    HeatmapVisualizer
  </a>
  
    <nav class="md-nav" aria-label="HeatmapVisualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.IPython" class="md-nav__link">
    IPython
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.MaskVisualizer" class="md-nav__link">
    MaskVisualizer
  </a>
  
    <nav class="md-nav" aria-label="MaskVisualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.MaskVisualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.NLP" class="md-nav__link">
    NLP
  </a>
  
    <nav class="md-nav" aria-label="NLP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.NLP.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.NLP.token_attribution" class="md-nav__link">
    token_attribution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Output" class="md-nav__link">
    Output
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.PlainText" class="md-nav__link">
    PlainText
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Tiler" class="md-nav__link">
    Tiler
  </a>
  
    <nav class="md-nav" aria-label="Tiler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Tiler.tile" class="md-nav__link">
    tile()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Visualizer" class="md-nav__link">
    Visualizer
  </a>
  
    <nav class="md-nav" aria-label="Visualizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Visualizer.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.visualizations.Visualizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="visualization-methods">Visualization Methods<a class="headerlink" href="#visualization-methods" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="trulens_explain.trulens.visualizations"></a>
  <div class="doc doc-contents first">
  
      <p>One clear use case for measuring attributions is for human consumption. In order
to be fully leveraged by humans, explanations need to be interpretable &mdash; a
large vector of numbers doesn‚Äôt in general make us more confident we understand
what a network is doing. We therefore view an <em>explanation</em> as comprised of both
an <em>attribution measurement</em> and an <em>interpretation</em> of what the attribution 
values represent.</p>
<p>One obvious way to interpret attributions, particularly in the image domain, is
via visualization. This module provides several visualization methods for
interpreting attributions as images.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.ChannelMaskVisualizer" class="doc doc-heading">
          <code>ChannelMaskVisualizer</code>


<a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Uses internal influence to visualize the pixels that are most salient
towards a particular internal channel or neuron.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ChannelMaskVisualizer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses internal influence to visualize the pixels that are most salient</span>
<span class="sd">    towards a particular internal channel or neuron.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">layer</span><span class="p">,</span>
        <span class="n">channel</span><span class="p">,</span>
        <span class="n">channel_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">agg_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">doi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">masked_opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">combine_channels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">use_attr_as_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">positive_only</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">        be overridden by passing in values to `__call__`).</span>

<span class="sd">        Parameters:</span>
<span class="sd">            model:</span>
<span class="sd">                The wrapped model whose channel we&#39;re visualizing.</span>

<span class="sd">            layer:</span>
<span class="sd">                The identifier (either index or name) of the layer in which the </span>
<span class="sd">                channel we&#39;re visualizing resides.</span>

<span class="sd">            channel:</span>
<span class="sd">                Index of the channel (for convolutional layers) or internal </span>
<span class="sd">                neuron (for fully-connected layers) that we&#39;d like to visualize.</span>

<span class="sd">            channel_axis:</span>
<span class="sd">                If different from the channel axis specified by the backend, the</span>
<span class="sd">                supplied `channel_axis` will be used if operating on a </span>
<span class="sd">                convolutional layer with 4-D image format.</span>

<span class="sd">            agg_fn:</span>
<span class="sd">                Function with which to aggregate the remaining dimensions </span>
<span class="sd">                (except the batch dimension) in order to get a single scalar </span>
<span class="sd">                value for each channel; If `None`, a sum over each neuron in the</span>
<span class="sd">                channel will be taken. This argument is not used when the </span>
<span class="sd">                channels are scalars, e.g., for dense layers.</span>

<span class="sd">            doi:</span>
<span class="sd">                The distribution of interest to use when computing the input</span>
<span class="sd">                attributions towards the specified channel. If `None`, </span>
<span class="sd">                `PointDoI` will be used.</span>

<span class="sd">            blur:</span>
<span class="sd">                Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">                attributions before visualizing. This can be used to help focus</span>
<span class="sd">                on salient regions rather than specific salient pixels.</span>

<span class="sd">            threshold:</span>
<span class="sd">                Value in the range [0, 1]. Attribution values at or  below the </span>
<span class="sd">                percentile given by `threshold` (after normalization, blurring,</span>
<span class="sd">                etc.) will be masked.</span>

<span class="sd">            masked_opacity: </span>
<span class="sd">                Value in the range [0, 1] specifying the opacity for the parts</span>
<span class="sd">                of the image that are masked.</span>

<span class="sd">            combine_channels:</span>
<span class="sd">                If `True`, the attributions will be averaged across the channel</span>
<span class="sd">                dimension, resulting in a 1-channel attribution map.</span>

<span class="sd">            use_attr_as_opacity:</span>
<span class="sd">                If `True`, instead of using `threshold` and `masked_opacity`,</span>
<span class="sd">                the opacity of each pixel is given by the 0-1-normalized </span>
<span class="sd">                attribution value.</span>

<span class="sd">            positive_only:</span>
<span class="sd">                If `True`, only pixels with positive attribution will be </span>
<span class="sd">                unmasked (or given nonzero opacity when `use_attr_as_opacity` is</span>
<span class="sd">                true).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">B</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">channel_axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">channel_axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)):</span>
            <span class="n">channel_axis</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">channel_axis</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">channel_axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">channel_axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mask_visualizer</span> <span class="o">=</span> <span class="n">MaskVisualizer</span><span class="p">(</span>
            <span class="n">blur</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="p">,</span> <span class="n">combine_channels</span><span class="p">,</span>
            <span class="n">use_attr_as_opacity</span><span class="p">,</span> <span class="n">positive_only</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">infl_input</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="n">InputCut</span><span class="p">(),</span> <span class="n">Cut</span><span class="p">(</span><span class="n">layer</span><span class="p">)),</span>
            <span class="n">InternalChannelQoI</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">channel_axis</span><span class="p">,</span> <span class="n">agg_fn</span><span class="p">),</span>
            <span class="n">PointDoi</span><span class="p">()</span> <span class="k">if</span> <span class="n">doi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">doi</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">x_preprocessed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">masked_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">combine_channels</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualizes the given attributions by overlaying an attribution heatmap </span>
<span class="sd">        over the given image.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        attributions : numpy.ndarray</span>
<span class="sd">            The attributions to visualize. Expected to be in 4-D image format.</span>

<span class="sd">        x : numpy.ndarray</span>
<span class="sd">            The original image(s) over which the attributions are calculated.</span>
<span class="sd">            Must be the same shape as expected by the model used with this</span>
<span class="sd">            visualizer.</span>

<span class="sd">        x_preprocessed : numpy.ndarray, optional</span>
<span class="sd">            If the model requires a preprocessed input (e.g., with the mean</span>
<span class="sd">            subtracted) that is different from how the image should be </span>
<span class="sd">            visualized, ``x_preprocessed`` should be specified. In this case </span>
<span class="sd">            ``x`` will be used for visualization, and ``x_preprocessed`` will be</span>
<span class="sd">            passed to the model when calculating attributions. Must be the same </span>
<span class="sd">            shape as ``x``.</span>

<span class="sd">        output_file : str, optional</span>
<span class="sd">            If specified, the resulting visualization will be saved to a file</span>
<span class="sd">            with the name given by ``output_file``.</span>

<span class="sd">        blur : float, optional</span>
<span class="sd">            If specified, gives the radius of a Gaussian blur to be applied to</span>
<span class="sd">            the attributions before visualizing. This can be used to help focus</span>
<span class="sd">            on salient regions rather than specific salient pixels. If None, </span>
<span class="sd">            defaults to the value supplied to the constructor. Default None.</span>

<span class="sd">        threshold : float</span>
<span class="sd">            Value in the range [0, 1]. Attribution values at or  below the </span>
<span class="sd">            percentile given by ``threshold`` will be masked. If None, defaults </span>
<span class="sd">            to the value supplied to the constructor. Default None.</span>

<span class="sd">        masked_opacity: float</span>
<span class="sd">            Value in the range [0, 1] specifying the opacity for the parts of</span>
<span class="sd">            the image that are masked. Default 0.2. If None, defaults to the </span>
<span class="sd">            value supplied to the constructor. Default None.</span>

<span class="sd">        combine_channels : bool</span>
<span class="sd">            If True, the attributions will be averaged across the channel</span>
<span class="sd">            dimension, resulting in a 1-channel attribution map. If None, </span>
<span class="sd">            defaults to the value supplied to the constructor. Default None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attrs_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">infl_input</span><span class="o">.</span><span class="n">attributions</span><span class="p">(</span>
            <span class="n">x</span> <span class="k">if</span> <span class="n">x_preprocessed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x_preprocessed</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_visualizer</span><span class="p">(</span>
            <span class="n">attrs_input</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="p">,</span>
            <span class="n">combine_channels</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_preprocessed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">combine_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Visualizes the given attributions by overlaying an attribution heatmap 
over the given image.</p>
<h5 id="trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__--parameters">Parameters<a class="headerlink" href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__call__--parameters" title="Permanent link">&para;</a></h5>
<p>attributions : numpy.ndarray
    The attributions to visualize. Expected to be in 4-D image format.</p>

<details class="x-" open>
  <summary>numpy.ndarray</summary>
  <p>The original image(s) over which the attributions are calculated.
Must be the same shape as expected by the model used with this
visualizer.</p>
</details>
<details class="x_preprocessed-" open>
  <summary>numpy.ndarray, optional</summary>
  <p>If the model requires a preprocessed input (e.g., with the mean
subtracted) that is different from how the image should be 
visualized, <code>x_preprocessed</code> should be specified. In this case 
<code>x</code> will be used for visualization, and <code>x_preprocessed</code> will be
passed to the model when calculating attributions. Must be the same 
shape as <code>x</code>.</p>
</details>
<details class="output_file-" open>
  <summary>str, optional</summary>
  <p>If specified, the resulting visualization will be saved to a file
with the name given by <code>output_file</code>.</p>
</details>
<details class="blur-" open>
  <summary>float, optional</summary>
  <p>If specified, gives the radius of a Gaussian blur to be applied to
the attributions before visualizing. This can be used to help focus
on salient regions rather than specific salient pixels. If None, 
defaults to the value supplied to the constructor. Default None.</p>
</details>
<details class="threshold-" open>
  <summary>float</summary>
  <p>Value in the range [0, 1]. Attribution values at or  below the 
percentile given by <code>threshold</code> will be masked. If None, defaults 
to the value supplied to the constructor. Default None.</p>
</details>
<details class="masked_opacity" open>
  <summary>float</summary>
  <p>Value in the range [0, 1] specifying the opacity for the parts of
the image that are masked. Default 0.2. If None, defaults to the 
value supplied to the constructor. Default None.</p>
</details>
<details class="combine_channels-" open>
  <summary>bool</summary>
  <p>If True, the attributions will be averaged across the channel
dimension, resulting in a 1-channel attribution map. If None, 
defaults to the value supplied to the constructor. Default None.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">x_preprocessed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">masked_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">combine_channels</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the given attributions by overlaying an attribution heatmap </span>
<span class="sd">    over the given image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attributions : numpy.ndarray</span>
<span class="sd">        The attributions to visualize. Expected to be in 4-D image format.</span>

<span class="sd">    x : numpy.ndarray</span>
<span class="sd">        The original image(s) over which the attributions are calculated.</span>
<span class="sd">        Must be the same shape as expected by the model used with this</span>
<span class="sd">        visualizer.</span>

<span class="sd">    x_preprocessed : numpy.ndarray, optional</span>
<span class="sd">        If the model requires a preprocessed input (e.g., with the mean</span>
<span class="sd">        subtracted) that is different from how the image should be </span>
<span class="sd">        visualized, ``x_preprocessed`` should be specified. In this case </span>
<span class="sd">        ``x`` will be used for visualization, and ``x_preprocessed`` will be</span>
<span class="sd">        passed to the model when calculating attributions. Must be the same </span>
<span class="sd">        shape as ``x``.</span>

<span class="sd">    output_file : str, optional</span>
<span class="sd">        If specified, the resulting visualization will be saved to a file</span>
<span class="sd">        with the name given by ``output_file``.</span>

<span class="sd">    blur : float, optional</span>
<span class="sd">        If specified, gives the radius of a Gaussian blur to be applied to</span>
<span class="sd">        the attributions before visualizing. This can be used to help focus</span>
<span class="sd">        on salient regions rather than specific salient pixels. If None, </span>
<span class="sd">        defaults to the value supplied to the constructor. Default None.</span>

<span class="sd">    threshold : float</span>
<span class="sd">        Value in the range [0, 1]. Attribution values at or  below the </span>
<span class="sd">        percentile given by ``threshold`` will be masked. If None, defaults </span>
<span class="sd">        to the value supplied to the constructor. Default None.</span>

<span class="sd">    masked_opacity: float</span>
<span class="sd">        Value in the range [0, 1] specifying the opacity for the parts of</span>
<span class="sd">        the image that are masked. Default 0.2. If None, defaults to the </span>
<span class="sd">        value supplied to the constructor. Default None.</span>

<span class="sd">    combine_channels : bool</span>
<span class="sd">        If True, the attributions will be averaged across the channel</span>
<span class="sd">        dimension, resulting in a 1-channel attribution map. If None, </span>
<span class="sd">        defaults to the value supplied to the constructor. Default None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">attrs_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">infl_input</span><span class="o">.</span><span class="n">attributions</span><span class="p">(</span>
        <span class="n">x</span> <span class="k">if</span> <span class="n">x_preprocessed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x_preprocessed</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_visualizer</span><span class="p">(</span>
        <span class="n">attrs_input</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="p">,</span>
        <span class="n">combine_channels</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__init__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">channel_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">agg_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">combine_channels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_attr_as_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">positive_only</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.ChannelMaskVisualizer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Configures the default parameters for the <code>__call__</code> method (these can 
be overridden by passing in values to <code>__call__</code>).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wrapped model whose channel we're visualizing.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>layer</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The identifier (either index or name) of the layer in which the 
channel we're visualizing resides.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>channel</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index of the channel (for convolutional layers) or internal 
neuron (for fully-connected layers) that we'd like to visualize.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>channel_axis</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If different from the channel axis specified by the backend, the
supplied <code>channel_axis</code> will be used if operating on a 
convolutional layer with 4-D image format.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>agg_fn</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Function with which to aggregate the remaining dimensions 
(except the batch dimension) in order to get a single scalar 
value for each channel; If <code>None</code>, a sum over each neuron in the
channel will be taken. This argument is not used when the 
channels are scalars, e.g., for dense layers.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>doi</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distribution of interest to use when computing the input
attributions towards the specified channel. If <code>None</code>, 
<code>PointDoI</code> will be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>blur</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Gives the radius of a Gaussian blur to be applied to the 
attributions before visualizing. This can be used to help focus
on salient regions rather than specific salient pixels.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value in the range [0, 1]. Attribution values at or  below the 
percentile given by <code>threshold</code> (after normalization, blurring,
etc.) will be masked.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>masked_opacity</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value in the range [0, 1] specifying the opacity for the parts
of the image that are masked.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>combine_channels</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the attributions will be averaged across the channel
dimension, resulting in a 1-channel attribution map.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_attr_as_opacity</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, instead of using <code>threshold</code> and <code>masked_opacity</code>,
the opacity of each pixel is given by the 0-1-normalized 
attribution value.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>positive_only</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, only pixels with positive attribution will be 
unmasked (or given nonzero opacity when <code>use_attr_as_opacity</code> is
true).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">layer</span><span class="p">,</span>
    <span class="n">channel</span><span class="p">,</span>
    <span class="n">channel_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">agg_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">doi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">masked_opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">combine_channels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_attr_as_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">positive_only</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">    be overridden by passing in values to `__call__`).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model:</span>
<span class="sd">            The wrapped model whose channel we&#39;re visualizing.</span>

<span class="sd">        layer:</span>
<span class="sd">            The identifier (either index or name) of the layer in which the </span>
<span class="sd">            channel we&#39;re visualizing resides.</span>

<span class="sd">        channel:</span>
<span class="sd">            Index of the channel (for convolutional layers) or internal </span>
<span class="sd">            neuron (for fully-connected layers) that we&#39;d like to visualize.</span>

<span class="sd">        channel_axis:</span>
<span class="sd">            If different from the channel axis specified by the backend, the</span>
<span class="sd">            supplied `channel_axis` will be used if operating on a </span>
<span class="sd">            convolutional layer with 4-D image format.</span>

<span class="sd">        agg_fn:</span>
<span class="sd">            Function with which to aggregate the remaining dimensions </span>
<span class="sd">            (except the batch dimension) in order to get a single scalar </span>
<span class="sd">            value for each channel; If `None`, a sum over each neuron in the</span>
<span class="sd">            channel will be taken. This argument is not used when the </span>
<span class="sd">            channels are scalars, e.g., for dense layers.</span>

<span class="sd">        doi:</span>
<span class="sd">            The distribution of interest to use when computing the input</span>
<span class="sd">            attributions towards the specified channel. If `None`, </span>
<span class="sd">            `PointDoI` will be used.</span>

<span class="sd">        blur:</span>
<span class="sd">            Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">            attributions before visualizing. This can be used to help focus</span>
<span class="sd">            on salient regions rather than specific salient pixels.</span>

<span class="sd">        threshold:</span>
<span class="sd">            Value in the range [0, 1]. Attribution values at or  below the </span>
<span class="sd">            percentile given by `threshold` (after normalization, blurring,</span>
<span class="sd">            etc.) will be masked.</span>

<span class="sd">        masked_opacity: </span>
<span class="sd">            Value in the range [0, 1] specifying the opacity for the parts</span>
<span class="sd">            of the image that are masked.</span>

<span class="sd">        combine_channels:</span>
<span class="sd">            If `True`, the attributions will be averaged across the channel</span>
<span class="sd">            dimension, resulting in a 1-channel attribution map.</span>

<span class="sd">        use_attr_as_opacity:</span>
<span class="sd">            If `True`, instead of using `threshold` and `masked_opacity`,</span>
<span class="sd">            the opacity of each pixel is given by the 0-1-normalized </span>
<span class="sd">            attribution value.</span>

<span class="sd">        positive_only:</span>
<span class="sd">            If `True`, only pixels with positive attribution will be </span>
<span class="sd">            unmasked (or given nonzero opacity when `use_attr_as_opacity` is</span>
<span class="sd">            true).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">B</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">channel_axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">channel_axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)):</span>
        <span class="n">channel_axis</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">channel_axis</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">channel_axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">channel_axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">mask_visualizer</span> <span class="o">=</span> <span class="n">MaskVisualizer</span><span class="p">(</span>
        <span class="n">blur</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="p">,</span> <span class="n">combine_channels</span><span class="p">,</span>
        <span class="n">use_attr_as_opacity</span><span class="p">,</span> <span class="n">positive_only</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">infl_input</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="n">InputCut</span><span class="p">(),</span> <span class="n">Cut</span><span class="p">(</span><span class="n">layer</span><span class="p">)),</span>
        <span class="n">InternalChannelQoI</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">channel_axis</span><span class="p">,</span> <span class="n">agg_fn</span><span class="p">),</span>
        <span class="n">PointDoi</span><span class="p">()</span> <span class="k">if</span> <span class="n">doi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">doi</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.HTML" class="doc doc-heading">
          <code>HTML</code>


<a href="#trulens_explain.trulens.visualizations.HTML" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.visualizations.Output" href="#trulens_explain.trulens.visualizations.Output">Output</a></code></p>

  
      <p>HTML visualization output format.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HTML</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;HTML visualization output format.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_html</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;HTML output requires html python module. Try &#39;pip install html&#39;.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">blank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&amp;nbsp;&quot;</span>

    <span class="k">def</span> <span class="nf">escape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">linebreak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span>

    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;span style=&#39;padding: 2px; margin: 2px; background: gray; border-radius: 4px;&#39;&gt;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&lt;/span&gt;&quot;</span>

    <span class="k">def</span> <span class="nf">magnitude_colored</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">mag</span><span class="p">):</span>
        <span class="n">red</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">green</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">mag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">green</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># 0.5 + mag * 0.5</span>
            <span class="n">red</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">mag</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">red</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">green</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">mag</span> <span class="o">*</span> <span class="mf">0.5</span>
            <span class="c1">#red = 0.5 - mag * 0.5</span>

        <span class="n">blue</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">)</span>
        <span class="c1"># blue = 1.0 - max(red, green)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;span title=&#39;</span><span class="si">{</span><span class="n">mag</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&#39; style=&#39;margin: 1px; padding: 1px; border-radius: 4px; background: black; color: rgb(</span><span class="si">{</span><span class="n">red</span><span class="o">*</span><span class="mi">255</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">green</span><span class="o">*</span><span class="mi">255</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">blue</span><span class="o">*</span><span class="mi">255</span><span class="si">}</span><span class="s2">);&#39;&gt;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&lt;/span&gt;&quot;</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pieces</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.HeatmapVisualizer" class="doc doc-heading">
          <code>HeatmapVisualizer</code>


<a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.visualizations.Visualizer" href="#trulens_explain.trulens.visualizations.Visualizer">Visualizer</a></code></p>

  
      <p>Visualizes attributions by overlaying an attribution heatmap over the
original image, similar to how GradCAM visualizes attributions.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HeatmapVisualizer</span><span class="p">(</span><span class="n">Visualizer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes attributions by overlaying an attribution heatmap over the</span>
<span class="sd">    original image, similar to how GradCAM visualizes attributions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">        be overridden by passing in values to `__call__`).</span>

<span class="sd">        Parameters:</span>
<span class="sd">            overlay_opacity: float</span>
<span class="sd">                Value in the range [0, 1] specifying the opacity for the heatmap</span>
<span class="sd">                overlay.</span>

<span class="sd">            normalization_type:</span>
<span class="sd">                Specifies one of the following configurations for normalizing</span>
<span class="sd">                the attributions (each item is normalized separately):</span>

<span class="sd">                - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">                  attribution value.</span>
<span class="sd">                - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5. </span>
<span class="sd">                - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then normalizes the attributions to the range </span>
<span class="sd">                  [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">                - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then scales them such that they sum to 1. If </span>
<span class="sd">                  this option is used, each channel is normalized separately, </span>
<span class="sd">                  such that each channel sums to 1.</span>
<span class="sd">                - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">                  positive attribution value and the negative values by the </span>
<span class="sd">                  minimum negative attribution value.</span>
<span class="sd">                - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5.</span>
<span class="sd">                - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">                  they sum to 1 and the negative attributions such that they</span>
<span class="sd">                  scale to -1. If this option is used, each channel is </span>
<span class="sd">                  normalized separately.</span>
<span class="sd">                - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">                  subtracting the minimum attribution value then dividing by the</span>
<span class="sd">                  maximum attribution value.</span>
<span class="sd">                - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">                If `None`, either `&#39;unsigned_max&#39;` (for single-channel data) or </span>
<span class="sd">                `&#39;unsigned_max_positive_centered&#39;` (for multi-channel data) is</span>
<span class="sd">                used.</span>

<span class="sd">            blur:</span>
<span class="sd">                Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">                attributions before visualizing. This can be used to help focus</span>
<span class="sd">                on salient regions rather than specific salient pixels.</span>

<span class="sd">            cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">                Colormap or name of a Colormap to use for the visualization. If </span>
<span class="sd">                `None`, the colormap will be chosen based on the normalization </span>
<span class="sd">                type. This argument is only used for single-channel data</span>
<span class="sd">                (including when `combine_channels` is True).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">combine_channels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">normalization_type</span><span class="o">=</span><span class="n">normalization_type</span><span class="p">,</span>
            <span class="n">blur</span><span class="o">=</span><span class="n">blur</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_overlay_opacity</span> <span class="o">=</span> <span class="n">overlay_opacity</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">attributions</span><span class="p">,</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">imshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">return_tiled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">overlay_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualizes the given attributions by overlaying an attribution heatmap </span>
<span class="sd">        over the given image.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            attributions:</span>
<span class="sd">                A `np.ndarray` containing the attributions to be visualized.</span>

<span class="sd">            x:</span>
<span class="sd">                A `np.ndarray` of items in the same shape as `attributions`</span>
<span class="sd">                corresponding to the records explained by the given </span>
<span class="sd">                attributions. The visualization will be superimposed onto the</span>
<span class="sd">                corresponding set of records.</span>

<span class="sd">            output_file:</span>
<span class="sd">                File name to save the visualization image to. If `None`, no</span>
<span class="sd">                image will be saved, but the figure can still be displayed.</span>

<span class="sd">            imshow:</span>
<span class="sd">                If true, a the visualization will be displayed. Otherwise the</span>
<span class="sd">                figure will not be displayed, but the figure can still be saved.</span>

<span class="sd">            fig:</span>
<span class="sd">                The `pyplot` figure to display the visualization in. If `None`,</span>
<span class="sd">                a new figure will be created.</span>

<span class="sd">            return_tiled:</span>
<span class="sd">                If true, the returned array will be in the same shape as the</span>
<span class="sd">                visualization, with no batch dimension and the samples in the</span>
<span class="sd">                batch tiled along the width and height dimensions. If false, the</span>
<span class="sd">                returned array will be reshaped to match `attributions`.</span>

<span class="sd">            overlay_opacity: float</span>
<span class="sd">                Value in the range [0, 1] specifying the opacity for the heatmap</span>
<span class="sd">                overlay. If `None`, defaults to the value supplied to the </span>
<span class="sd">                constructor.</span>

<span class="sd">            normalization_type:</span>
<span class="sd">                Specifies one of the following configurations for normalizing</span>
<span class="sd">                the attributions (each item is normalized separately):</span>

<span class="sd">                - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">                  attribution value.</span>
<span class="sd">                - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5. </span>
<span class="sd">                - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then normalizes the attributions to the range </span>
<span class="sd">                  [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">                - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then scales them such that they sum to 1. If </span>
<span class="sd">                  this option is used, each channel is normalized separately, </span>
<span class="sd">                  such that each channel sums to 1.</span>
<span class="sd">                - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">                  positive attribution value and the negative values by the </span>
<span class="sd">                  minimum negative attribution value.</span>
<span class="sd">                - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5.</span>
<span class="sd">                - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">                  they sum to 1 and the negative attributions such that they</span>
<span class="sd">                  scale to -1. If this option is used, each channel is </span>
<span class="sd">                  normalized separately.</span>
<span class="sd">                - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">                  subtracting the minimum attribution value then dividing by the</span>
<span class="sd">                  maximum attribution value.</span>
<span class="sd">                - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">                If `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">            blur:</span>
<span class="sd">                Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">                attributions before visualizing. This can be used to help focus</span>
<span class="sd">                on salient regions rather than specific salient pixels. If</span>
<span class="sd">                `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">            cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">                Colormap or name of a Colormap to use for the visualization. If</span>
<span class="sd">                `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A `np.ndarray` array of the numerical representation of the</span>
<span class="sd">            attributions as modified for the visualization. This includes </span>
<span class="sd">            normalization, blurring, etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_args</span><span class="p">(</span>
            <span class="n">attributions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span>
        <span class="p">)</span>

        <span class="c1"># Combine the channels.</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="n">attributions</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="c1"># Blur the attributions so the explanation is smoother.</span>
        <span class="k">if</span> <span class="n">blur</span><span class="p">:</span>
            <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blur</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">blur</span><span class="p">)</span>

        <span class="c1"># Normalize the attributions.</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">)</span>

        <span class="n">tiled_attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

        <span class="c1"># Normalize the pixels to be in the range [0, 1].</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">)</span>
        <span class="n">tiled_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_cmap</span>

        <span class="k">if</span> <span class="n">overlay_opacity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">overlay_opacity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_overlay_opacity</span>

        <span class="c1"># Display the figure:</span>
        <span class="n">_fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span> <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fig</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tiled_x</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tiled_attributions</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">overlay_opacity</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">imshow</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">_fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tiled_attributions</span> <span class="k">if</span> <span class="n">return_tiled</span> <span class="k">else</span> <span class="n">attributions</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.HeatmapVisualizer.__call__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">imshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_tiled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Visualizes the given attributions by overlaying an attribution heatmap 
over the given image.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attributions</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A <code>np.ndarray</code> containing the attributions to be visualized.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A <code>np.ndarray</code> of items in the same shape as <code>attributions</code>
corresponding to the records explained by the given 
attributions. The visualization will be superimposed onto the
corresponding set of records.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>File name to save the visualization image to. If <code>None</code>, no
image will be saved, but the figure can still be displayed.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>imshow</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, a the visualization will be displayed. Otherwise the
figure will not be displayed, but the figure can still be saved.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fig</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The <code>pyplot</code> figure to display the visualization in. If <code>None</code>,
a new figure will be created.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>return_tiled</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, the returned array will be in the same shape as the
visualization, with no batch dimension and the samples in the
batch tiled along the width and height dimensions. If false, the
returned array will be reshaped to match <code>attributions</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_opacity</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>float
Value in the range [0, 1] specifying the opacity for the heatmap
overlay. If <code>None</code>, defaults to the value supplied to the 
constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>normalization_type</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Specifies one of the following configurations for normalizing
the attributions (each item is normalized separately):</p>
<ul>
<li><code>'unsigned_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the attributions by the maximum absolute 
  attribution value.</li>
<li><code>'unsigned_max_positive_centered'</code>: same as above, but scales
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5. </li>
<li><code>'magnitude_max'</code>: takes the absolute value of the 
  attributions, then normalizes the attributions to the range 
  [0, 1] by dividing by the maximum absolute attribution value.</li>
<li><code>'magnitude_sum'</code>: takes the absolute value of the 
  attributions, then scales them such that they sum to 1. If 
  this option is used, each channel is normalized separately, 
  such that each channel sums to 1.</li>
<li><code>'signed_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the positive values by the maximum 
  positive attribution value and the negative values by the 
  minimum negative attribution value.</li>
<li><code>'signed_max_positive_centered'</code>: same as above, but scales 
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5.</li>
<li><code>'signed_sum'</code>: scales the positive attributions such that 
  they sum to 1 and the negative attributions such that they
  scale to -1. If this option is used, each channel is 
  normalized separately.</li>
<li><code>'01'</code>: normalizes the attributions to the range [0, 1] by 
  subtracting the minimum attribution value then dividing by the
  maximum attribution value.</li>
<li><code>'unnormalized'</code>: leaves the attributions unaffected.</li>
</ul>
<p>If <code>None</code>, defaults to the value supplied to the constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>blur</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Gives the radius of a Gaussian blur to be applied to the 
attributions before visualizing. This can be used to help focus
on salient regions rather than specific salient pixels. If
<code>None</code>, defaults to the value supplied to the constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cmap</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>matplotlib.colors.Colormap | str, optional
Colormap or name of a Colormap to use for the visualization. If
<code>None</code>, defaults to the value supplied to the constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A <code>np.ndarray</code> array of the numerical representation of the</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>attributions as modified for the visualization. This includes </p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>normalization, blurring, etc.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">attributions</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">imshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_tiled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the given attributions by overlaying an attribution heatmap </span>
<span class="sd">    over the given image.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        attributions:</span>
<span class="sd">            A `np.ndarray` containing the attributions to be visualized.</span>

<span class="sd">        x:</span>
<span class="sd">            A `np.ndarray` of items in the same shape as `attributions`</span>
<span class="sd">            corresponding to the records explained by the given </span>
<span class="sd">            attributions. The visualization will be superimposed onto the</span>
<span class="sd">            corresponding set of records.</span>

<span class="sd">        output_file:</span>
<span class="sd">            File name to save the visualization image to. If `None`, no</span>
<span class="sd">            image will be saved, but the figure can still be displayed.</span>

<span class="sd">        imshow:</span>
<span class="sd">            If true, a the visualization will be displayed. Otherwise the</span>
<span class="sd">            figure will not be displayed, but the figure can still be saved.</span>

<span class="sd">        fig:</span>
<span class="sd">            The `pyplot` figure to display the visualization in. If `None`,</span>
<span class="sd">            a new figure will be created.</span>

<span class="sd">        return_tiled:</span>
<span class="sd">            If true, the returned array will be in the same shape as the</span>
<span class="sd">            visualization, with no batch dimension and the samples in the</span>
<span class="sd">            batch tiled along the width and height dimensions. If false, the</span>
<span class="sd">            returned array will be reshaped to match `attributions`.</span>

<span class="sd">        overlay_opacity: float</span>
<span class="sd">            Value in the range [0, 1] specifying the opacity for the heatmap</span>
<span class="sd">            overlay. If `None`, defaults to the value supplied to the </span>
<span class="sd">            constructor.</span>

<span class="sd">        normalization_type:</span>
<span class="sd">            Specifies one of the following configurations for normalizing</span>
<span class="sd">            the attributions (each item is normalized separately):</span>

<span class="sd">            - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">              attribution value.</span>
<span class="sd">            - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5. </span>
<span class="sd">            - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then normalizes the attributions to the range </span>
<span class="sd">              [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">            - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then scales them such that they sum to 1. If </span>
<span class="sd">              this option is used, each channel is normalized separately, </span>
<span class="sd">              such that each channel sums to 1.</span>
<span class="sd">            - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">              positive attribution value and the negative values by the </span>
<span class="sd">              minimum negative attribution value.</span>
<span class="sd">            - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5.</span>
<span class="sd">            - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">              they sum to 1 and the negative attributions such that they</span>
<span class="sd">              scale to -1. If this option is used, each channel is </span>
<span class="sd">              normalized separately.</span>
<span class="sd">            - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">              subtracting the minimum attribution value then dividing by the</span>
<span class="sd">              maximum attribution value.</span>
<span class="sd">            - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">            If `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">        blur:</span>
<span class="sd">            Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">            attributions before visualizing. This can be used to help focus</span>
<span class="sd">            on salient regions rather than specific salient pixels. If</span>
<span class="sd">            `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">        cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">            Colormap or name of a Colormap to use for the visualization. If</span>
<span class="sd">            `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `np.ndarray` array of the numerical representation of the</span>
<span class="sd">        attributions as modified for the visualization. This includes </span>
<span class="sd">        normalization, blurring, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_args</span><span class="p">(</span>
        <span class="n">attributions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span>
    <span class="p">)</span>

    <span class="c1"># Combine the channels.</span>
    <span class="n">attributions</span> <span class="o">=</span> <span class="n">attributions</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Blur the attributions so the explanation is smoother.</span>
    <span class="k">if</span> <span class="n">blur</span><span class="p">:</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blur</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">blur</span><span class="p">)</span>

    <span class="c1"># Normalize the attributions.</span>
    <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">)</span>

    <span class="n">tiled_attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

    <span class="c1"># Normalize the pixels to be in the range [0, 1].</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">)</span>
    <span class="n">tiled_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_cmap</span>

    <span class="k">if</span> <span class="n">overlay_opacity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">overlay_opacity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_overlay_opacity</span>

    <span class="c1"># Display the figure:</span>
    <span class="n">_fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span> <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fig</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tiled_x</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tiled_attributions</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">overlay_opacity</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">imshow</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">_fig</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tiled_attributions</span> <span class="k">if</span> <span class="n">return_tiled</span> <span class="k">else</span> <span class="n">attributions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.HeatmapVisualizer.__init__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.HeatmapVisualizer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Configures the default parameters for the <code>__call__</code> method (these can 
be overridden by passing in values to <code>__call__</code>).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>overlay_opacity</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>float
Value in the range [0, 1] specifying the opacity for the heatmap
overlay.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>normalization_type</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Specifies one of the following configurations for normalizing
the attributions (each item is normalized separately):</p>
<ul>
<li><code>'unsigned_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the attributions by the maximum absolute 
  attribution value.</li>
<li><code>'unsigned_max_positive_centered'</code>: same as above, but scales
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5. </li>
<li><code>'magnitude_max'</code>: takes the absolute value of the 
  attributions, then normalizes the attributions to the range 
  [0, 1] by dividing by the maximum absolute attribution value.</li>
<li><code>'magnitude_sum'</code>: takes the absolute value of the 
  attributions, then scales them such that they sum to 1. If 
  this option is used, each channel is normalized separately, 
  such that each channel sums to 1.</li>
<li><code>'signed_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the positive values by the maximum 
  positive attribution value and the negative values by the 
  minimum negative attribution value.</li>
<li><code>'signed_max_positive_centered'</code>: same as above, but scales 
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5.</li>
<li><code>'signed_sum'</code>: scales the positive attributions such that 
  they sum to 1 and the negative attributions such that they
  scale to -1. If this option is used, each channel is 
  normalized separately.</li>
<li><code>'01'</code>: normalizes the attributions to the range [0, 1] by 
  subtracting the minimum attribution value then dividing by the
  maximum attribution value.</li>
<li><code>'unnormalized'</code>: leaves the attributions unaffected.</li>
</ul>
<p>If <code>None</code>, either <code>'unsigned_max'</code> (for single-channel data) or 
<code>'unsigned_max_positive_centered'</code> (for multi-channel data) is
used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>blur</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Gives the radius of a Gaussian blur to be applied to the 
attributions before visualizing. This can be used to help focus
on salient regions rather than specific salient pixels.</p>
            </div>
          </td>
          <td>
                <code>10.0</code>
          </td>
        </tr>
        <tr>
          <td><code>cmap</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>matplotlib.colors.Colormap | str, optional
Colormap or name of a Colormap to use for the visualization. If 
<code>None</code>, the colormap will be chosen based on the normalization 
type. This argument is only used for single-channel data
(including when <code>combine_channels</code> is True).</p>
            </div>
          </td>
          <td>
                <code>&#39;jet&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">blur</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">    be overridden by passing in values to `__call__`).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        overlay_opacity: float</span>
<span class="sd">            Value in the range [0, 1] specifying the opacity for the heatmap</span>
<span class="sd">            overlay.</span>

<span class="sd">        normalization_type:</span>
<span class="sd">            Specifies one of the following configurations for normalizing</span>
<span class="sd">            the attributions (each item is normalized separately):</span>

<span class="sd">            - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">              attribution value.</span>
<span class="sd">            - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5. </span>
<span class="sd">            - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then normalizes the attributions to the range </span>
<span class="sd">              [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">            - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then scales them such that they sum to 1. If </span>
<span class="sd">              this option is used, each channel is normalized separately, </span>
<span class="sd">              such that each channel sums to 1.</span>
<span class="sd">            - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">              positive attribution value and the negative values by the </span>
<span class="sd">              minimum negative attribution value.</span>
<span class="sd">            - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5.</span>
<span class="sd">            - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">              they sum to 1 and the negative attributions such that they</span>
<span class="sd">              scale to -1. If this option is used, each channel is </span>
<span class="sd">              normalized separately.</span>
<span class="sd">            - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">              subtracting the minimum attribution value then dividing by the</span>
<span class="sd">              maximum attribution value.</span>
<span class="sd">            - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">            If `None`, either `&#39;unsigned_max&#39;` (for single-channel data) or </span>
<span class="sd">            `&#39;unsigned_max_positive_centered&#39;` (for multi-channel data) is</span>
<span class="sd">            used.</span>

<span class="sd">        blur:</span>
<span class="sd">            Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">            attributions before visualizing. This can be used to help focus</span>
<span class="sd">            on salient regions rather than specific salient pixels.</span>

<span class="sd">        cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">            Colormap or name of a Colormap to use for the visualization. If </span>
<span class="sd">            `None`, the colormap will be chosen based on the normalization </span>
<span class="sd">            type. This argument is only used for single-channel data</span>
<span class="sd">            (including when `combine_channels` is True).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">combine_channels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">normalization_type</span><span class="o">=</span><span class="n">normalization_type</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="n">blur</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_overlay_opacity</span> <span class="o">=</span> <span class="n">overlay_opacity</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.IPython" class="doc doc-heading">
          <code>IPython</code>


<a href="#trulens_explain.trulens.visualizations.IPython" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.visualizations.HTML" href="#trulens_explain.trulens.visualizations.HTML">HTML</a></code></p>

  
      <p>Interactive python visualization output format.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IPython</span><span class="p">(</span><span class="n">HTML</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interactive python visualization output format.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IPython</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_ipy</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;IPython&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;Jupyter output requires IPython python module. Try &#39;pip install ipykernel&#39;.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">HTML</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_ipy</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.MaskVisualizer" class="doc doc-heading">
          <code>MaskVisualizer</code>


<a href="#trulens_explain.trulens.visualizations.MaskVisualizer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Visualizes attributions by masking the original image to highlight the
regions with influence above a given threshold percentile. Intended 
particularly for use with input-attributions.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MaskVisualizer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes attributions by masking the original image to highlight the</span>
<span class="sd">    regions with influence above a given threshold percentile. Intended </span>
<span class="sd">    particularly for use with input-attributions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">masked_opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">combine_channels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">use_attr_as_opacity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">positive_only</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">        be overridden by passing in values to `__call__`).</span>

<span class="sd">        Parameters:</span>
<span class="sd">            blur:</span>
<span class="sd">                Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">                attributions before visualizing. This can be used to help focus</span>
<span class="sd">                on salient regions rather than specific salient pixels.</span>

<span class="sd">            threshold:</span>
<span class="sd">                Value in the range [0, 1]. Attribution values at or  below the </span>
<span class="sd">                percentile given by `threshold` (after normalization, blurring,</span>
<span class="sd">                etc.) will be masked.</span>

<span class="sd">            masked_opacity: </span>
<span class="sd">                Value in the range [0, 1] specifying the opacity for the parts</span>
<span class="sd">                of the image that are masked.</span>

<span class="sd">            combine_channels:</span>
<span class="sd">                If `True`, the attributions will be averaged across the channel</span>
<span class="sd">                dimension, resulting in a 1-channel attribution map.</span>

<span class="sd">            use_attr_as_opacity:</span>
<span class="sd">                If `True`, instead of using `threshold` and `masked_opacity`,</span>
<span class="sd">                the opacity of each pixel is given by the 0-1-normalized </span>
<span class="sd">                attribution value.</span>

<span class="sd">            positive_only:</span>
<span class="sd">                If `True`, only pixels with positive attribution will be </span>
<span class="sd">                unmasked (or given nonzero opacity when `use_attr_as_opacity` is</span>
<span class="sd">                true).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_blur</span> <span class="o">=</span> <span class="n">blur</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_thresh</span> <span class="o">=</span> <span class="n">threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_masked_opacity</span> <span class="o">=</span> <span class="n">masked_opacity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_combine_channels</span> <span class="o">=</span> <span class="n">combine_channels</span>

        <span class="c1"># TODO(klas): in the future we can allow configuring of tiling settings</span>
        <span class="c1">#   by allowing the user to specify the tiler.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span> <span class="o">=</span> <span class="n">Tiler</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">attributions</span><span class="p">,</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">imshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">return_tiled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">masked_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">combine_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">use_attr_as_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">positive_only</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">channel_axis</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">channel_axis</span>
        <span class="k">if</span> <span class="n">attributions</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Shape of `attributions` </span><span class="si">{}</span><span class="s1"> must match shape of `x` </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">blur</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">blur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_blur</span>

        <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_thresh</span>

        <span class="k">if</span> <span class="n">masked_opacity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">masked_opacity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_masked_opacity</span>

        <span class="k">if</span> <span class="n">combine_channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">combine_channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_combine_channels</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;`MaskVisualizer` is inteded for 4-D image-format data. Given &#39;</span>
                <span class="s1">&#39;input with dimension </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">combine_channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">combine_channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_combine_channels</span>

        <span class="k">if</span> <span class="n">combine_channels</span><span class="p">:</span>
            <span class="n">attributions</span> <span class="o">=</span> <span class="n">attributions</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">channel_axis</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;To visualize, attributions must have either 1, 3, or 4 color &#39;</span>
                <span class="s1">&#39;channels, but Visualizer got </span><span class="si">{}</span><span class="s1"> channels.</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;If you are visualizing an internal layer, consider setting &#39;</span>
                <span class="s1">&#39;`combine_channels` to True&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">channel_axis</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Blur the attributions so the explanation is smoother.</span>
        <span class="k">if</span> <span class="n">blur</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">blur</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributions</span><span class="p">]</span>

        <span class="c1"># If `positive_only` clip attributions.</span>
        <span class="k">if</span> <span class="n">positive_only</span><span class="p">:</span>
            <span class="n">attributions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Normalize the attributions to be in the range [0, 1].</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributions</span><span class="p">]</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">0.</span> <span class="o">*</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.</span> <span class="k">else</span> <span class="n">a</span> <span class="o">/</span> <span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributions</span>
        <span class="p">]</span>

        <span class="c1"># Normalize the pixels to be in the range [0, 1]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">xc</span> <span class="o">-</span> <span class="n">xc</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span> <span class="o">*</span> <span class="n">xc</span> <span class="k">if</span> <span class="n">xc</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.</span> <span class="k">else</span> <span class="n">xc</span> <span class="o">/</span> <span class="n">xc</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>

        <span class="c1"># Threshold the attributions to create a mask.</span>
        <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">percentiles</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">threshold</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributions</span>
            <span class="p">]</span>
            <span class="n">masks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">masks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

        <span class="c1"># Use the mask on the original image to visualize the explanation.</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="n">masks</span> <span class="o">*</span> <span class="n">x</span>
        <span class="n">tiled_attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">imshow</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tiled_attributions</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tiled_attributions</span> <span class="k">if</span> <span class="n">return_tiled</span> <span class="k">else</span> <span class="n">attributions</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.MaskVisualizer.__init__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">blur</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">masked_opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">combine_channels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_attr_as_opacity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">positive_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.MaskVisualizer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Configures the default parameters for the <code>__call__</code> method (these can 
be overridden by passing in values to <code>__call__</code>).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blur</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Gives the radius of a Gaussian blur to be applied to the 
attributions before visualizing. This can be used to help focus
on salient regions rather than specific salient pixels.</p>
            </div>
          </td>
          <td>
                <code>5.0</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value in the range [0, 1]. Attribution values at or  below the 
percentile given by <code>threshold</code> (after normalization, blurring,
etc.) will be masked.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>masked_opacity</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value in the range [0, 1] specifying the opacity for the parts
of the image that are masked.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>combine_channels</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the attributions will be averaged across the channel
dimension, resulting in a 1-channel attribution map.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_attr_as_opacity</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, instead of using <code>threshold</code> and <code>masked_opacity</code>,
the opacity of each pixel is given by the 0-1-normalized 
attribution value.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>positive_only</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, only pixels with positive attribution will be 
unmasked (or given nonzero opacity when <code>use_attr_as_opacity</code> is
true).</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">blur</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">masked_opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">combine_channels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">use_attr_as_opacity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">positive_only</span><span class="o">=</span><span class="kc">True</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">    be overridden by passing in values to `__call__`).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        blur:</span>
<span class="sd">            Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">            attributions before visualizing. This can be used to help focus</span>
<span class="sd">            on salient regions rather than specific salient pixels.</span>

<span class="sd">        threshold:</span>
<span class="sd">            Value in the range [0, 1]. Attribution values at or  below the </span>
<span class="sd">            percentile given by `threshold` (after normalization, blurring,</span>
<span class="sd">            etc.) will be masked.</span>

<span class="sd">        masked_opacity: </span>
<span class="sd">            Value in the range [0, 1] specifying the opacity for the parts</span>
<span class="sd">            of the image that are masked.</span>

<span class="sd">        combine_channels:</span>
<span class="sd">            If `True`, the attributions will be averaged across the channel</span>
<span class="sd">            dimension, resulting in a 1-channel attribution map.</span>

<span class="sd">        use_attr_as_opacity:</span>
<span class="sd">            If `True`, instead of using `threshold` and `masked_opacity`,</span>
<span class="sd">            the opacity of each pixel is given by the 0-1-normalized </span>
<span class="sd">            attribution value.</span>

<span class="sd">        positive_only:</span>
<span class="sd">            If `True`, only pixels with positive attribution will be </span>
<span class="sd">            unmasked (or given nonzero opacity when `use_attr_as_opacity` is</span>
<span class="sd">            true).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_blur</span> <span class="o">=</span> <span class="n">blur</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_thresh</span> <span class="o">=</span> <span class="n">threshold</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_masked_opacity</span> <span class="o">=</span> <span class="n">masked_opacity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_combine_channels</span> <span class="o">=</span> <span class="n">combine_channels</span>

    <span class="c1"># TODO(klas): in the future we can allow configuring of tiling settings</span>
    <span class="c1">#   by allowing the user to specify the tiler.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span> <span class="o">=</span> <span class="n">Tiler</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.NLP" class="doc doc-heading">
          <code>NLP</code>


<a href="#trulens_explain.trulens.visualizations.NLP" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>NLP Visualization tools.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NLP</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;NLP Visualization tools.&quot;&quot;&quot;</span>

    <span class="c1"># Batches of text inputs not yet tokenized.</span>
    <span class="n">TextBatch</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;TextBatch&quot;</span><span class="p">)</span>

    <span class="c1"># Inputs that are directly accepted by wrapped models, tokenized.</span>
    <span class="c1"># TODO(piotrm): Reuse other typevars/aliases from elsewhere.</span>
    <span class="n">ModelInput</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ModelInput&quot;</span><span class="p">)</span>

    <span class="c1"># Outputs produced by wrapped models.</span>
    <span class="c1"># TODO(piotrm): Reuse other typevars/aliases from elsewhere.</span>
    <span class="n">ModelOutput</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ModelOutput&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">wrapper</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Output</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tokenize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">TextBatch</span><span class="p">],</span> <span class="n">ModelInputs</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">decode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Tensor</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">input_accessor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ModelInputs</span><span class="p">],</span>
                                          <span class="n">Iterable</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_accessor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ModelOutput</span><span class="p">],</span>
                                           <span class="n">Iterable</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attr_aggregate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hidden_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializate NLP visualization tools for a given environment.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            wrapper: ModelWrapper</span>
<span class="sd">                The wrapped model whose channel we&#39;re visualizing.</span>

<span class="sd">            output: Output, optional</span>
<span class="sd">                Visualization output format. Defaults to PlainText unless</span>
<span class="sd">                ipython is detected and in which case defaults to IPython</span>
<span class="sd">                format.</span>

<span class="sd">            labels: Iterable[str], optional</span>
<span class="sd">                Names of prediction classes for classification models.</span>

<span class="sd">            tokenize: Callable[[TextBatch], ModelInput], optional</span>
<span class="sd">                Method to tokenize an instance.</span>

<span class="sd">            decode: Callable[[Tensor], str], optional</span>
<span class="sd">                Method to invert/decode the tokenization.</span>

<span class="sd">            input_accessor: Callable[[ModelInputs], Iterable[Tensor]], optional</span>
<span class="sd">                Method to extract input/token ids from model inputs (tokenize</span>
<span class="sd">                output) if needed.</span>

<span class="sd">            output_accessor: Callable[[ModelOutput], Iterable[Tensor]], optional</span>
<span class="sd">                Method to extract outout logits from output structures if</span>
<span class="sd">                needed.</span>

<span class="sd">            attr_aggregate: Callable[[Tensor], Tensor], optional</span>
<span class="sd">                Method to aggregate attribution for embedding into a single</span>
<span class="sd">                value. Defaults to sum.</span>

<span class="sd">            hidden_tokens: Set[int], optional</span>
<span class="sd">                For token-based visualizations, which tokens to hide.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># check if running in interactive python (jupyer, colab, etc) to</span>
                <span class="c1"># use appropriate output format</span>
                <span class="n">get_ipython</span><span class="p">()</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">IPython</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">PlainText</span><span class="p">()</span>
                <span class="n">tru_logger</span><span class="p">(</span>
                    <span class="s2">&quot;WARNING: could not guess preferred visualization output format, using PlainText&quot;</span>
                <span class="p">)</span>

        <span class="c1"># TODO: automatic inference of various parameters for common repositories like huggingface, tfhub.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokenize</span> <span class="o">=</span> <span class="n">tokenize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decode</span> <span class="o">=</span> <span class="n">decode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">wrapper</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input_accessor</span> <span class="o">=</span> <span class="n">input_accessor</span>  <span class="c1"># could be inferred</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_accessor</span> <span class="o">=</span> <span class="n">output_accessor</span>  <span class="c1"># could be inferred</span>

        <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">attr_aggregate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr_aggregate</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">sum</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attr_aggregate</span> <span class="o">=</span> <span class="n">attr_aggregate</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_tokens</span> <span class="o">=</span> <span class="n">hidden_tokens</span>

    <span class="k">def</span> <span class="nf">token_attribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">attr</span><span class="p">:</span> <span class="n">AttributionMethod</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visualize a token-based input attribution on given `texts` inputs via the attribution method `attr`.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            texts: Iterable[str]</span>
<span class="sd">                The input texts to visualize.</span>

<span class="sd">            attr: AttributionMethod</span>
<span class="sd">                The attribution method to generate the token importances with.</span>

<span class="sd">        Returns: Any</span>
<span class="sd">            The visualization in the format specified by this class&#39;s `output` parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;tokenize not provided to NLP visualizer.&quot;</span><span class="p">)</span>

        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">call_on</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">_model</span><span class="p">)</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">call_on</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">attributions</span><span class="p">)</span>

        <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>

        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_accessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">input_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_accessor</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Inputs (</span><span class="si">{</span><span class="n">input_ids</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">) need to be iterable over instances. You might need to set input_accessor.&quot;</span>
            <span class="p">)</span>

        <span class="n">output_logits</span> <span class="o">=</span> <span class="n">outputs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_accessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_accessor</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_logits</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">output_logits</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Outputs (</span><span class="si">{</span><span class="n">output_logits</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">) need to be iterable over instances. You might need to set output_accessor.&quot;</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">sentence_word_id</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span>
                <span class="n">logits</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">output_logits</span><span class="p">)):</span>

            <span class="n">logits</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pred_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">pred</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pred_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

            <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">pred_name</span><span class="p">),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">space</span><span class="p">()</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">word_id</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sentence_word_id</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                <span class="n">word_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">as_array</span><span class="p">(</span><span class="n">word_id</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">word_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_tokens</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">word</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">word_id</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">word</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">word_id</span><span class="p">)</span>

                <span class="n">mag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_aggregate</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                    <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">space</span><span class="p">())</span>

                <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">sent</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">magnitude_colored</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">word</span><span class="p">),</span> <span class="n">mag</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">content</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">sent</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">linebreak</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">linebreak</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.NLP.__init__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tokenize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_accessor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_accessor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr_aggregate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hidden_tokens</span><span class="o">=</span><span class="nb">set</span><span class="p">())</span></code>

<a href="#trulens_explain.trulens.visualizations.NLP.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializate NLP visualization tools for a given environment.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wrapper</code></td>
          <td>
                <code><span title="trulens.nn.models._model_base.ModelWrapper">ModelWrapper</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ModelWrapper
The wrapped model whose channel we're visualizing.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="trulens_explain.trulens.visualizations.Output" href="#trulens_explain.trulens.visualizations.Output">Output</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output, optional
Visualization output format. Defaults to PlainText unless
ipython is detected and in which case defaults to IPython
format.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Iterable">Iterable</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable[str], optional
Names of prediction classes for classification models.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>tokenize</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="trulens_explain.trulens.visualizations.NLP.TextBatch">TextBatch</span>], <span title="trulens.utils.typing.ModelInputs">ModelInputs</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callable[[TextBatch], ModelInput], optional
Method to tokenize an instance.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>decode</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="trulens.utils.typing.Tensor">Tensor</span>], str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callable[[Tensor], str], optional
Method to invert/decode the tokenization.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>input_accessor</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="trulens.utils.typing.ModelInputs">ModelInputs</span>], <span title="typing.Iterable">Iterable</span>[<span title="trulens.utils.typing.Tensor">Tensor</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callable[[ModelInputs], Iterable[Tensor]], optional
Method to extract input/token ids from model inputs (tokenize
output) if needed.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_accessor</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="trulens_explain.trulens.visualizations.NLP.ModelOutput">ModelOutput</span>], <span title="typing.Iterable">Iterable</span>[<span title="trulens.utils.typing.Tensor">Tensor</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callable[[ModelOutput], Iterable[Tensor]], optional
Method to extract outout logits from output structures if
needed.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>attr_aggregate</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="trulens.utils.typing.Tensor">Tensor</span>], <span title="trulens.utils.typing.Tensor">Tensor</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callable[[Tensor], Tensor], optional
Method to aggregate attribution for embedding into a single
value. Defaults to sum.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hidden_tokens</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Set">Set</span>[int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set[int], optional
For token-based visualizations, which tokens to hide.</p>
            </div>
          </td>
          <td>
                <code>set()</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Output</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tokenize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">TextBatch</span><span class="p">],</span> <span class="n">ModelInputs</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">decode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Tensor</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">input_accessor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ModelInputs</span><span class="p">],</span>
                                      <span class="n">Iterable</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_accessor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ModelOutput</span><span class="p">],</span>
                                       <span class="n">Iterable</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">attr_aggregate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hidden_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializate NLP visualization tools for a given environment.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        wrapper: ModelWrapper</span>
<span class="sd">            The wrapped model whose channel we&#39;re visualizing.</span>

<span class="sd">        output: Output, optional</span>
<span class="sd">            Visualization output format. Defaults to PlainText unless</span>
<span class="sd">            ipython is detected and in which case defaults to IPython</span>
<span class="sd">            format.</span>

<span class="sd">        labels: Iterable[str], optional</span>
<span class="sd">            Names of prediction classes for classification models.</span>

<span class="sd">        tokenize: Callable[[TextBatch], ModelInput], optional</span>
<span class="sd">            Method to tokenize an instance.</span>

<span class="sd">        decode: Callable[[Tensor], str], optional</span>
<span class="sd">            Method to invert/decode the tokenization.</span>

<span class="sd">        input_accessor: Callable[[ModelInputs], Iterable[Tensor]], optional</span>
<span class="sd">            Method to extract input/token ids from model inputs (tokenize</span>
<span class="sd">            output) if needed.</span>

<span class="sd">        output_accessor: Callable[[ModelOutput], Iterable[Tensor]], optional</span>
<span class="sd">            Method to extract outout logits from output structures if</span>
<span class="sd">            needed.</span>

<span class="sd">        attr_aggregate: Callable[[Tensor], Tensor], optional</span>
<span class="sd">            Method to aggregate attribution for embedding into a single</span>
<span class="sd">            value. Defaults to sum.</span>

<span class="sd">        hidden_tokens: Set[int], optional</span>
<span class="sd">            For token-based visualizations, which tokens to hide.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># check if running in interactive python (jupyer, colab, etc) to</span>
            <span class="c1"># use appropriate output format</span>
            <span class="n">get_ipython</span><span class="p">()</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">IPython</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">PlainText</span><span class="p">()</span>
            <span class="n">tru_logger</span><span class="p">(</span>
                <span class="s2">&quot;WARNING: could not guess preferred visualization output format, using PlainText&quot;</span>
            <span class="p">)</span>

    <span class="c1"># TODO: automatic inference of various parameters for common repositories like huggingface, tfhub.</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tokenize</span> <span class="o">=</span> <span class="n">tokenize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decode</span> <span class="o">=</span> <span class="n">decode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">wrapper</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_accessor</span> <span class="o">=</span> <span class="n">input_accessor</span>  <span class="c1"># could be inferred</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output_accessor</span> <span class="o">=</span> <span class="n">output_accessor</span>  <span class="c1"># could be inferred</span>

    <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">attr_aggregate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">attr_aggregate</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">sum</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">attr_aggregate</span> <span class="o">=</span> <span class="n">attr_aggregate</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">hidden_tokens</span> <span class="o">=</span> <span class="n">hidden_tokens</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.NLP.token_attribution" class="doc doc-heading">
          <code class=" language-python"><span class="n">token_attribution</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.NLP.token_attribution" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Visualize a token-based input attribution on given <code>texts</code> inputs via the attribution method <code>attr</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>texts</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable[str]
The input texts to visualize.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td>
                <code><span title="trulens.nn.attribution.AttributionMethod">AttributionMethod</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>AttributionMethod
The attribution method to generate the token importances with.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Any</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The visualization in the format specified by this class's <code>output</code> parameter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">token_attribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">attr</span><span class="p">:</span> <span class="n">AttributionMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize a token-based input attribution on given `texts` inputs via the attribution method `attr`.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        texts: Iterable[str]</span>
<span class="sd">            The input texts to visualize.</span>

<span class="sd">        attr: AttributionMethod</span>
<span class="sd">            The attribution method to generate the token importances with.</span>

<span class="sd">    Returns: Any</span>
<span class="sd">        The visualization in the format specified by this class&#39;s `output` parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;tokenize not provided to NLP visualizer.&quot;</span><span class="p">)</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">call_on</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">_model</span><span class="p">)</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">call_on</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">attributions</span><span class="p">)</span>

    <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>

    <span class="n">input_ids</span> <span class="o">=</span> <span class="n">inputs</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_accessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_accessor</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Inputs (</span><span class="si">{</span><span class="n">input_ids</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">) need to be iterable over instances. You might need to set input_accessor.&quot;</span>
        <span class="p">)</span>

    <span class="n">output_logits</span> <span class="o">=</span> <span class="n">outputs</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_accessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_accessor</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_logits</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">output_logits</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Outputs (</span><span class="si">{</span><span class="n">output_logits</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">) need to be iterable over instances. You might need to set output_accessor.&quot;</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">sentence_word_id</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span>
            <span class="n">logits</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">output_logits</span><span class="p">)):</span>

        <span class="n">logits</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pred_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">pred</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pred_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

        <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">pred_name</span><span class="p">),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">space</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">word_id</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sentence_word_id</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
            <span class="n">word_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">as_array</span><span class="p">(</span><span class="n">word_id</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">word_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_tokens</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">word</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">word_id</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">word</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">word_id</span><span class="p">)</span>

            <span class="n">mag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_aggregate</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">space</span><span class="p">())</span>

            <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">sent</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">magnitude_colored</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">word</span><span class="p">),</span> <span class="n">mag</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">content</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">sent</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">linebreak</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">linebreak</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.Output" class="doc doc-heading">
          <code>Output</code>


<a href="#trulens_explain.trulens.visualizations.Output" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Base class for visualization output formats.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Output</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for visualization output formats.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">blank</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">space</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">escape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">magnitude_colored</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mag</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">parts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.PlainText" class="doc doc-heading">
          <code>PlainText</code>


<a href="#trulens_explain.trulens.visualizations.PlainText" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.visualizations.Output" href="#trulens_explain.trulens.visualizations.Output">Output</a></code></p>

  
      <p>Plain text visualization output format.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PlainText</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plain text visualization output format.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">blank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; &quot;</span>

    <span class="k">def</span> <span class="nf">escape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">magnitude_colored</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">mag</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">mag</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">parts</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.Tiler" class="doc doc-heading">
          <code>Tiler</code>


<a href="#trulens_explain.trulens.visualizations.Tiler" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Used to tile batched images or attributions.</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Tiler</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to tile batched images or attributions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tiles the given array into a grid that is as square as possible.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            a:</span>
<span class="sd">                An array of 4D batched image data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tiled array of the images from `a`. The resulting array has rank</span>
<span class="sd">            3 for color images, and 2 for grayscale images (the batch dimension</span>
<span class="sd">            is removed, as well as the channel dimension for grayscale images).</span>
<span class="sd">            The resulting array has its color channel dimension ordered last to</span>
<span class="sd">            fit the requirements of the `matplotlib` library.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># `pyplot` expects the channels to come last.</span>
        <span class="k">if</span> <span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">dim_order</span> <span class="o">==</span> <span class="s1">&#39;channels_first&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">rows</span><span class="p">))</span>

        <span class="n">new_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">h</span> <span class="o">*</span> <span class="n">rows</span><span class="p">,</span> <span class="n">w</span> <span class="o">*</span> <span class="n">cols</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
            <span class="n">new_a</span><span class="p">[</span><span class="n">row</span> <span class="o">*</span> <span class="n">h</span><span class="p">:(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">col</span> <span class="o">*</span> <span class="n">w</span><span class="p">:(</span><span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">new_a</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.Tiler.tile" class="doc doc-heading">
          <code class=" language-python"><span class="n">tile</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.Tiler.tile" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Tiles the given array into a grid that is as square as possible.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array of 4D batched image data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tiled array of the images from <code>a</code>. The resulting array has rank</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>3 for color images, and 2 for grayscale images (the batch dimension</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>is removed, as well as the channel dimension for grayscale images).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The resulting array has its color channel dimension ordered last to</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>fit the requirements of the <code>matplotlib</code> library.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tiles the given array into a grid that is as square as possible.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        a:</span>
<span class="sd">            An array of 4D batched image data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tiled array of the images from `a`. The resulting array has rank</span>
<span class="sd">        3 for color images, and 2 for grayscale images (the batch dimension</span>
<span class="sd">        is removed, as well as the channel dimension for grayscale images).</span>
<span class="sd">        The resulting array has its color channel dimension ordered last to</span>
<span class="sd">        fit the requirements of the `matplotlib` library.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># `pyplot` expects the channels to come last.</span>
    <span class="k">if</span> <span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">dim_order</span> <span class="o">==</span> <span class="s1">&#39;channels_first&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">rows</span><span class="p">))</span>

    <span class="n">new_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">h</span> <span class="o">*</span> <span class="n">rows</span><span class="p">,</span> <span class="n">w</span> <span class="o">*</span> <span class="n">cols</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
        <span class="n">new_a</span><span class="p">[</span><span class="n">row</span> <span class="o">*</span> <span class="n">h</span><span class="p">:(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">col</span> <span class="o">*</span> <span class="n">w</span><span class="p">:(</span><span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">new_a</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="trulens_explain.trulens.visualizations.Visualizer" class="doc doc-heading">
          <code>Visualizer</code>


<a href="#trulens_explain.trulens.visualizations.Visualizer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Visualizes attributions directly as a color image. Intended particularly for
use with input-attributions.</p>
<p>This can also be used for viewing images (rather than attributions).</p>

            <details class="quote">
              <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Visualizer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes attributions directly as a color image. Intended particularly for</span>
<span class="sd">    use with input-attributions.</span>

<span class="sd">    This can also be used for viewing images (rather than attributions).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">combine_channels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">normalization_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">blur</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
        <span class="n">cmap</span><span class="p">:</span> <span class="n">Colormap</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">        be overridden by passing in values to `__call__`).</span>

<span class="sd">        Parameters:</span>
<span class="sd">            combine_channels:</span>
<span class="sd">                If `True`, the attributions will be averaged across the channel</span>
<span class="sd">                dimension, resulting in a 1-channel attribution map.</span>

<span class="sd">            normalization_type:</span>
<span class="sd">                Specifies one of the following configurations for normalizing</span>
<span class="sd">                the attributions (each item is normalized separately):</span>

<span class="sd">                - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">                  attribution value.</span>
<span class="sd">                - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5. </span>
<span class="sd">                - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then normalizes the attributions to the range </span>
<span class="sd">                  [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">                - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then scales them such that they sum to 1. If </span>
<span class="sd">                  this option is used, each channel is normalized separately, </span>
<span class="sd">                  such that each channel sums to 1.</span>
<span class="sd">                - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">                  positive attribution value and the negative values by the </span>
<span class="sd">                  minimum negative attribution value.</span>
<span class="sd">                - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5.</span>
<span class="sd">                - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">                  they sum to 1 and the negative attributions such that they</span>
<span class="sd">                  scale to -1. If this option is used, each channel is </span>
<span class="sd">                  normalized separately.</span>
<span class="sd">                - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">                  subtracting the minimum attribution value then dividing by the</span>
<span class="sd">                  maximum attribution value.</span>
<span class="sd">                - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">                If `None`, either `&#39;unsigned_max&#39;` (for single-channel data) or </span>
<span class="sd">                `&#39;unsigned_max_positive_centered&#39;` (for multi-channel data) is</span>
<span class="sd">                used.</span>

<span class="sd">            blur:</span>
<span class="sd">                Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">                attributions before visualizing. This can be used to help focus</span>
<span class="sd">                on salient regions rather than specific salient pixels.</span>

<span class="sd">            cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">                Colormap or name of a Colormap to use for the visualization. If </span>
<span class="sd">                `None`, the colormap will be chosen based on the normalization </span>
<span class="sd">                type. This argument is only used for single-channel data</span>
<span class="sd">                (including when `combine_channels` is True).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_combine_channels</span> <span class="o">=</span> <span class="n">combine_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_normalization_type</span> <span class="o">=</span> <span class="n">normalization_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_blur</span> <span class="o">=</span> <span class="n">blur</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_cmap</span> <span class="o">=</span> <span class="n">cmap</span> <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hotcold</span><span class="p">()</span>

        <span class="c1"># TODO(klas): in the future we can allow configuring of tiling settings</span>
        <span class="c1">#   by allowing the user to specify the tiler.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span> <span class="o">=</span> <span class="n">Tiler</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">attributions</span><span class="p">,</span>
        <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">imshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">return_tiled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">combine_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualizes the given attributions.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            attributions:</span>
<span class="sd">                A `np.ndarray` containing the attributions to be visualized.</span>

<span class="sd">            output_file:</span>
<span class="sd">                File name to save the visualization image to. If `None`, no</span>
<span class="sd">                image will be saved, but the figure can still be displayed.</span>

<span class="sd">            imshow:</span>
<span class="sd">                If true, a the visualization will be displayed. Otherwise the</span>
<span class="sd">                figure will not be displayed, but the figure can still be saved.</span>

<span class="sd">            fig:</span>
<span class="sd">                The `pyplot` figure to display the visualization in. If `None`,</span>
<span class="sd">                a new figure will be created.</span>

<span class="sd">            return_tiled:</span>
<span class="sd">                If true, the returned array will be in the same shape as the</span>
<span class="sd">                visualization, with no batch dimension and the samples in the</span>
<span class="sd">                batch tiled along the width and height dimensions. If false, the</span>
<span class="sd">                returned array will be reshaped to match `attributions`.</span>

<span class="sd">            combine_channels:</span>
<span class="sd">                If `True`, the attributions will be averaged across the channel</span>
<span class="sd">                dimension, resulting in a 1-channel attribution map. If `None`,</span>
<span class="sd">                defaults to the value supplied to the constructor.</span>

<span class="sd">            normalization_type:</span>
<span class="sd">                Specifies one of the following configurations for normalizing</span>
<span class="sd">                the attributions (each item is normalized separately):</span>

<span class="sd">                - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">                  attribution value.</span>
<span class="sd">                - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5. </span>
<span class="sd">                - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then normalizes the attributions to the range </span>
<span class="sd">                  [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">                - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">                  attributions, then scales them such that they sum to 1. If </span>
<span class="sd">                  this option is used, each channel is normalized separately, </span>
<span class="sd">                  such that each channel sums to 1.</span>
<span class="sd">                - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">                  [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">                  positive attribution value and the negative values by the </span>
<span class="sd">                  minimum negative attribution value.</span>
<span class="sd">                - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">                  the values to the range [0, 1], with negative scores less than</span>
<span class="sd">                  0.5 and positive scores greater than 0.5.</span>
<span class="sd">                - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">                  they sum to 1 and the negative attributions such that they</span>
<span class="sd">                  scale to -1. If this option is used, each channel is </span>
<span class="sd">                  normalized separately.</span>
<span class="sd">                - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">                  subtracting the minimum attribution value then dividing by the</span>
<span class="sd">                  maximum attribution value.</span>
<span class="sd">                - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">                If `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">            blur:</span>
<span class="sd">                Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">                attributions before visualizing. This can be used to help focus</span>
<span class="sd">                on salient regions rather than specific salient pixels. If</span>
<span class="sd">                `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">            cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">                Colormap or name of a Colormap to use for the visualization. If</span>
<span class="sd">                `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A `np.ndarray` array of the numerical representation of the</span>
<span class="sd">            attributions as modified for the visualization. This includes </span>
<span class="sd">            normalization, blurring, etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">combine_channels</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_args</span><span class="p">(</span>
            <span class="n">attributions</span><span class="p">,</span> <span class="n">combine_channels</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span>
        <span class="p">)</span>

        <span class="c1"># Combine the channels if specified.</span>
        <span class="k">if</span> <span class="n">combine_channels</span><span class="p">:</span>
            <span class="n">attributions</span> <span class="o">=</span> <span class="n">attributions</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                <span class="n">axis</span><span class="o">=</span><span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

        <span class="c1"># Blur the attributions so the explanation is smoother.</span>
        <span class="k">if</span> <span class="n">blur</span><span class="p">:</span>
            <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blur</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">blur</span><span class="p">)</span>

        <span class="c1"># Normalize the attributions.</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">)</span>

        <span class="n">tiled_attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

        <span class="c1"># Display the figure:</span>
        <span class="n">_fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span> <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fig</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tiled_attributions</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">imshow</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">_fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tiled_attributions</span> <span class="k">if</span> <span class="n">return_tiled</span> <span class="k">else</span> <span class="n">attributions</span>

    <span class="k">def</span> <span class="nf">_check_args</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">attributions</span><span class="p">,</span> <span class="n">combine_channels</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the arguments, and sets them to their default values if they</span>
<span class="sd">        are not specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attributions</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;`Visualizer` is inteded for 4-D image-format data. Given &#39;</span>
                <span class="s1">&#39;input with dimension </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attributions</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">combine_channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">combine_channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_combine_channels</span>

        <span class="n">channel_axis</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">channel_axis</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">channel_axis</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">combine_channels</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;To visualize, attributions must have either 1, 3, or 4 color &#39;</span>
                <span class="s1">&#39;channels, but `Visualizer` got </span><span class="si">{}</span><span class="s1"> channels.</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;If you are visualizing an internal layer, consider setting &#39;</span>
                <span class="s1">&#39;`combine_channels` to True&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">channel_axis</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">normalization_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">normalization_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_normalization_type</span>

            <span class="k">if</span> <span class="n">normalization_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">combine_channels</span> <span class="ow">or</span> <span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">channel_axis</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">normalization_type</span> <span class="o">=</span> <span class="s1">&#39;unsigned_max&#39;</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">normalization_type</span> <span class="o">=</span> <span class="s1">&#39;unsigned_max_positive_centered&#39;</span>

        <span class="n">valid_normalization_types</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;unsigned_max&#39;</span><span class="p">,</span>
            <span class="s1">&#39;unsigned_max_positive_centered&#39;</span><span class="p">,</span>
            <span class="s1">&#39;magnitude_max&#39;</span><span class="p">,</span>
            <span class="s1">&#39;magnitude_sum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;signed_max&#39;</span><span class="p">,</span>
            <span class="s1">&#39;signed_max_positive_centered&#39;</span><span class="p">,</span>
            <span class="s1">&#39;signed_sum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;01&#39;</span><span class="p">,</span>
            <span class="s1">&#39;unnormalized&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">normalization_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_normalization_types</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;`norm` must be None or one of the following options:&#39;</span> <span class="o">+</span>
                <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">form</span><span class="p">(</span><span class="n">norm_type</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">norm_type</span> <span class="ow">in</span> <span class="n">valid_normalization_types</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">blur</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">blur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_blur</span>

        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_cmap</span>

        <span class="k">return</span> <span class="n">combine_channels</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span>

    <span class="k">def</span> <span class="nf">_normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributions</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-20</span><span class="p">):</span>
        <span class="n">channel_axis</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">channel_axis</span>
        <span class="k">if</span> <span class="n">normalization_type</span> <span class="o">==</span> <span class="s1">&#39;unnormalized&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">attributions</span>

        <span class="n">split_by_channel</span> <span class="o">=</span> <span class="n">normalization_type</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>

        <span class="n">channel_split</span> <span class="o">=</span> <span class="p">[</span><span class="n">attributions</span><span class="p">]</span> <span class="k">if</span> <span class="n">split_by_channel</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
            <span class="n">attributions</span><span class="p">,</span> <span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">channel_axis</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span>
        <span class="p">)</span>

        <span class="n">normalized_attributions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c_map</span> <span class="ow">in</span> <span class="n">channel_split</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">normalization_type</span> <span class="o">==</span> <span class="s1">&#39;magnitude_max&#39;</span><span class="p">:</span>
                <span class="n">c_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">c_map</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">c_map</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">normalization_type</span> <span class="o">==</span> <span class="s1">&#39;magnitude_sum&#39;</span><span class="p">:</span>
                <span class="n">c_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">c_map</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">c_map</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">normalization_type</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;signed_max&#39;</span><span class="p">):</span>
                <span class="n">postive_max</span> <span class="o">=</span> <span class="n">c_map</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">negative_max</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">c_map</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="c1"># Normalize the postive socres to [0, 1] and negative socresn to</span>
                <span class="c1"># [-1, 0].</span>
                <span class="n">normalization_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="n">c_map</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">postive_max</span><span class="p">,</span> <span class="n">negative_max</span>
                <span class="p">)</span>
                <span class="n">c_map</span> <span class="o">=</span> <span class="n">c_map</span> <span class="o">/</span> <span class="p">(</span><span class="n">normalization_factor</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>

                <span class="c1"># If positive-centered, normalize so that all scores are in the</span>
                <span class="c1"># range [0, 1], with negative scores less than 0.5 and positive</span>
                <span class="c1"># scores greater than 0.5.</span>
                <span class="k">if</span> <span class="n">normalization_type</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;positive_centered&#39;</span><span class="p">):</span>
                    <span class="n">c_map</span> <span class="o">=</span> <span class="n">c_map</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="mf">0.5</span>

            <span class="k">elif</span> <span class="n">normalization_type</span> <span class="o">==</span> <span class="s1">&#39;signed_sum&#39;</span><span class="p">:</span>
                <span class="n">postive_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">c_map</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                    <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="n">negative_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="o">-</span><span class="n">c_map</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                    <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>

                <span class="c1"># Normalize the postive socres to ensure they sum to 1 and the</span>
                <span class="c1"># negative scores to ensure they sum to -1.</span>
                <span class="n">normalization_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="n">c_map</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">postive_max</span><span class="p">,</span> <span class="n">negative_max</span>
                <span class="p">)</span>
                <span class="n">c_map</span> <span class="o">=</span> <span class="n">c_map</span> <span class="o">/</span> <span class="p">(</span><span class="n">normalization_factor</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">normalization_type</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;unsigned_max&#39;</span><span class="p">):</span>
                <span class="n">c_map</span> <span class="o">=</span> <span class="n">c_map</span> <span class="o">/</span> <span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">c_map</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span>
                <span class="p">)</span>

                <span class="c1"># If positive-centered, normalize so that all scores are in the</span>
                <span class="c1"># range [0, 1], with negative scores less than 0.5 and positive</span>
                <span class="c1"># scores greater than 0.5.</span>
                <span class="k">if</span> <span class="n">normalization_type</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;positive_centered&#39;</span><span class="p">):</span>
                    <span class="n">c_map</span> <span class="o">=</span> <span class="n">c_map</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="mf">0.5</span>

            <span class="k">elif</span> <span class="n">normalization_type</span> <span class="o">==</span> <span class="s1">&#39;01&#39;</span><span class="p">:</span>
                <span class="n">c_map</span> <span class="o">=</span> <span class="n">c_map</span> <span class="o">-</span> <span class="n">c_map</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">c_map</span> <span class="o">=</span> <span class="n">c_map</span> <span class="o">/</span> <span class="p">(</span><span class="n">c_map</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>

            <span class="n">normalized_attributions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_map</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">normalized_attributions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">channel_axis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_blur</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributions</span><span class="p">,</span> <span class="n">blur</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">attributions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">attributions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">attributions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">blur</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">attributions</span>

    <span class="k">def</span> <span class="nf">_get_hotcold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hot</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="n">cool</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;cool&#39;</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="n">binary</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="n">hotcold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">binary</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span> <span class="o">*</span> <span class="n">cool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">)),</span>
                <span class="n">hot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">hotcold</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;hotcold&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.Visualizer.__call__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">imshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_tiled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">combine_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.Visualizer.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Visualizes the given attributions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>attributions</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A <code>np.ndarray</code> containing the attributions to be visualized.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>File name to save the visualization image to. If <code>None</code>, no
image will be saved, but the figure can still be displayed.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>imshow</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, a the visualization will be displayed. Otherwise the
figure will not be displayed, but the figure can still be saved.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fig</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The <code>pyplot</code> figure to display the visualization in. If <code>None</code>,
a new figure will be created.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>return_tiled</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, the returned array will be in the same shape as the
visualization, with no batch dimension and the samples in the
batch tiled along the width and height dimensions. If false, the
returned array will be reshaped to match <code>attributions</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>combine_channels</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the attributions will be averaged across the channel
dimension, resulting in a 1-channel attribution map. If <code>None</code>,
defaults to the value supplied to the constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>normalization_type</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Specifies one of the following configurations for normalizing
the attributions (each item is normalized separately):</p>
<ul>
<li><code>'unsigned_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the attributions by the maximum absolute 
  attribution value.</li>
<li><code>'unsigned_max_positive_centered'</code>: same as above, but scales
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5. </li>
<li><code>'magnitude_max'</code>: takes the absolute value of the 
  attributions, then normalizes the attributions to the range 
  [0, 1] by dividing by the maximum absolute attribution value.</li>
<li><code>'magnitude_sum'</code>: takes the absolute value of the 
  attributions, then scales them such that they sum to 1. If 
  this option is used, each channel is normalized separately, 
  such that each channel sums to 1.</li>
<li><code>'signed_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the positive values by the maximum 
  positive attribution value and the negative values by the 
  minimum negative attribution value.</li>
<li><code>'signed_max_positive_centered'</code>: same as above, but scales 
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5.</li>
<li><code>'signed_sum'</code>: scales the positive attributions such that 
  they sum to 1 and the negative attributions such that they
  scale to -1. If this option is used, each channel is 
  normalized separately.</li>
<li><code>'01'</code>: normalizes the attributions to the range [0, 1] by 
  subtracting the minimum attribution value then dividing by the
  maximum attribution value.</li>
<li><code>'unnormalized'</code>: leaves the attributions unaffected.</li>
</ul>
<p>If <code>None</code>, defaults to the value supplied to the constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>blur</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Gives the radius of a Gaussian blur to be applied to the 
attributions before visualizing. This can be used to help focus
on salient regions rather than specific salient pixels. If
<code>None</code>, defaults to the value supplied to the constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cmap</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>matplotlib.colors.Colormap | str, optional
Colormap or name of a Colormap to use for the visualization. If
<code>None</code>, defaults to the value supplied to the constructor.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A <code>np.ndarray</code> array of the numerical representation of the</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>attributions as modified for the visualization. This includes </p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>normalization, blurring, etc.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">attributions</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">imshow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_tiled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">combine_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">blur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the given attributions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        attributions:</span>
<span class="sd">            A `np.ndarray` containing the attributions to be visualized.</span>

<span class="sd">        output_file:</span>
<span class="sd">            File name to save the visualization image to. If `None`, no</span>
<span class="sd">            image will be saved, but the figure can still be displayed.</span>

<span class="sd">        imshow:</span>
<span class="sd">            If true, a the visualization will be displayed. Otherwise the</span>
<span class="sd">            figure will not be displayed, but the figure can still be saved.</span>

<span class="sd">        fig:</span>
<span class="sd">            The `pyplot` figure to display the visualization in. If `None`,</span>
<span class="sd">            a new figure will be created.</span>

<span class="sd">        return_tiled:</span>
<span class="sd">            If true, the returned array will be in the same shape as the</span>
<span class="sd">            visualization, with no batch dimension and the samples in the</span>
<span class="sd">            batch tiled along the width and height dimensions. If false, the</span>
<span class="sd">            returned array will be reshaped to match `attributions`.</span>

<span class="sd">        combine_channels:</span>
<span class="sd">            If `True`, the attributions will be averaged across the channel</span>
<span class="sd">            dimension, resulting in a 1-channel attribution map. If `None`,</span>
<span class="sd">            defaults to the value supplied to the constructor.</span>

<span class="sd">        normalization_type:</span>
<span class="sd">            Specifies one of the following configurations for normalizing</span>
<span class="sd">            the attributions (each item is normalized separately):</span>

<span class="sd">            - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">              attribution value.</span>
<span class="sd">            - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5. </span>
<span class="sd">            - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then normalizes the attributions to the range </span>
<span class="sd">              [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">            - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then scales them such that they sum to 1. If </span>
<span class="sd">              this option is used, each channel is normalized separately, </span>
<span class="sd">              such that each channel sums to 1.</span>
<span class="sd">            - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">              positive attribution value and the negative values by the </span>
<span class="sd">              minimum negative attribution value.</span>
<span class="sd">            - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5.</span>
<span class="sd">            - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">              they sum to 1 and the negative attributions such that they</span>
<span class="sd">              scale to -1. If this option is used, each channel is </span>
<span class="sd">              normalized separately.</span>
<span class="sd">            - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">              subtracting the minimum attribution value then dividing by the</span>
<span class="sd">              maximum attribution value.</span>
<span class="sd">            - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">            If `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">        blur:</span>
<span class="sd">            Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">            attributions before visualizing. This can be used to help focus</span>
<span class="sd">            on salient regions rather than specific salient pixels. If</span>
<span class="sd">            `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">        cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">            Colormap or name of a Colormap to use for the visualization. If</span>
<span class="sd">            `None`, defaults to the value supplied to the constructor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `np.ndarray` array of the numerical representation of the</span>
<span class="sd">        attributions as modified for the visualization. This includes </span>
<span class="sd">        normalization, blurring, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">combine_channels</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_args</span><span class="p">(</span>
        <span class="n">attributions</span><span class="p">,</span> <span class="n">combine_channels</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">,</span> <span class="n">blur</span><span class="p">,</span> <span class="n">cmap</span>
    <span class="p">)</span>

    <span class="c1"># Combine the channels if specified.</span>
    <span class="k">if</span> <span class="n">combine_channels</span><span class="p">:</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="n">attributions</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">channel_axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

    <span class="c1"># Blur the attributions so the explanation is smoother.</span>
    <span class="k">if</span> <span class="n">blur</span><span class="p">:</span>
        <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blur</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">blur</span><span class="p">)</span>

    <span class="c1"># Normalize the attributions.</span>
    <span class="n">attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">(</span><span class="n">attributions</span><span class="p">,</span> <span class="n">normalization_type</span><span class="p">)</span>

    <span class="n">tiled_attributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

    <span class="c1"># Display the figure:</span>
    <span class="n">_fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span> <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fig</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">tiled_attributions</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">imshow</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">_fig</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tiled_attributions</span> <span class="k">if</span> <span class="n">return_tiled</span> <span class="k">else</span> <span class="n">attributions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="trulens_explain.trulens.visualizations.Visualizer.__init__" class="doc doc-heading">
          <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">combine_channels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalization_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.visualizations.Visualizer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Configures the default parameters for the <code>__call__</code> method (these can 
be overridden by passing in values to <code>__call__</code>).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>combine_channels</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the attributions will be averaged across the channel
dimension, resulting in a 1-channel attribution map.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>normalization_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Specifies one of the following configurations for normalizing
the attributions (each item is normalized separately):</p>
<ul>
<li><code>'unsigned_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the attributions by the maximum absolute 
  attribution value.</li>
<li><code>'unsigned_max_positive_centered'</code>: same as above, but scales
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5. </li>
<li><code>'magnitude_max'</code>: takes the absolute value of the 
  attributions, then normalizes the attributions to the range 
  [0, 1] by dividing by the maximum absolute attribution value.</li>
<li><code>'magnitude_sum'</code>: takes the absolute value of the 
  attributions, then scales them such that they sum to 1. If 
  this option is used, each channel is normalized separately, 
  such that each channel sums to 1.</li>
<li><code>'signed_max'</code>: normalizes the attributions to the range 
  [-1, 1] by dividing the positive values by the maximum 
  positive attribution value and the negative values by the 
  minimum negative attribution value.</li>
<li><code>'signed_max_positive_centered'</code>: same as above, but scales 
  the values to the range [0, 1], with negative scores less than
  0.5 and positive scores greater than 0.5.</li>
<li><code>'signed_sum'</code>: scales the positive attributions such that 
  they sum to 1 and the negative attributions such that they
  scale to -1. If this option is used, each channel is 
  normalized separately.</li>
<li><code>'01'</code>: normalizes the attributions to the range [0, 1] by 
  subtracting the minimum attribution value then dividing by the
  maximum attribution value.</li>
<li><code>'unnormalized'</code>: leaves the attributions unaffected.</li>
</ul>
<p>If <code>None</code>, either <code>'unsigned_max'</code> (for single-channel data) or 
<code>'unsigned_max_positive_centered'</code> (for multi-channel data) is
used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>blur</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Gives the radius of a Gaussian blur to be applied to the 
attributions before visualizing. This can be used to help focus
on salient regions rather than specific salient pixels.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>cmap</code></td>
          <td>
                <code><span title="matplotlib.colors.Colormap">Colormap</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>matplotlib.colors.Colormap | str, optional
Colormap or name of a Colormap to use for the visualization. If 
<code>None</code>, the colormap will be chosen based on the normalization 
type. This argument is only used for single-channel data
(including when <code>combine_channels</code> is True).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>trulens_explain/trulens/visualizations.py</code></summary>
            <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">combine_channels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">normalization_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">blur</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">cmap</span><span class="p">:</span> <span class="n">Colormap</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configures the default parameters for the `__call__` method (these can </span>
<span class="sd">    be overridden by passing in values to `__call__`).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        combine_channels:</span>
<span class="sd">            If `True`, the attributions will be averaged across the channel</span>
<span class="sd">            dimension, resulting in a 1-channel attribution map.</span>

<span class="sd">        normalization_type:</span>
<span class="sd">            Specifies one of the following configurations for normalizing</span>
<span class="sd">            the attributions (each item is normalized separately):</span>

<span class="sd">            - `&#39;unsigned_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the attributions by the maximum absolute </span>
<span class="sd">              attribution value.</span>
<span class="sd">            - `&#39;unsigned_max_positive_centered&#39;`: same as above, but scales</span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5. </span>
<span class="sd">            - `&#39;magnitude_max&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then normalizes the attributions to the range </span>
<span class="sd">              [0, 1] by dividing by the maximum absolute attribution value.</span>
<span class="sd">            - `&#39;magnitude_sum&#39;`: takes the absolute value of the </span>
<span class="sd">              attributions, then scales them such that they sum to 1. If </span>
<span class="sd">              this option is used, each channel is normalized separately, </span>
<span class="sd">              such that each channel sums to 1.</span>
<span class="sd">            - `&#39;signed_max&#39;`: normalizes the attributions to the range </span>
<span class="sd">              [-1, 1] by dividing the positive values by the maximum </span>
<span class="sd">              positive attribution value and the negative values by the </span>
<span class="sd">              minimum negative attribution value.</span>
<span class="sd">            - `&#39;signed_max_positive_centered&#39;`: same as above, but scales </span>
<span class="sd">              the values to the range [0, 1], with negative scores less than</span>
<span class="sd">              0.5 and positive scores greater than 0.5.</span>
<span class="sd">            - `&#39;signed_sum&#39;`: scales the positive attributions such that </span>
<span class="sd">              they sum to 1 and the negative attributions such that they</span>
<span class="sd">              scale to -1. If this option is used, each channel is </span>
<span class="sd">              normalized separately.</span>
<span class="sd">            - `&#39;01&#39;`: normalizes the attributions to the range [0, 1] by </span>
<span class="sd">              subtracting the minimum attribution value then dividing by the</span>
<span class="sd">              maximum attribution value.</span>
<span class="sd">            - `&#39;unnormalized&#39;`: leaves the attributions unaffected.</span>

<span class="sd">            If `None`, either `&#39;unsigned_max&#39;` (for single-channel data) or </span>
<span class="sd">            `&#39;unsigned_max_positive_centered&#39;` (for multi-channel data) is</span>
<span class="sd">            used.</span>

<span class="sd">        blur:</span>
<span class="sd">            Gives the radius of a Gaussian blur to be applied to the </span>
<span class="sd">            attributions before visualizing. This can be used to help focus</span>
<span class="sd">            on salient regions rather than specific salient pixels.</span>

<span class="sd">        cmap: matplotlib.colors.Colormap | str, optional</span>
<span class="sd">            Colormap or name of a Colormap to use for the visualization. If </span>
<span class="sd">            `None`, the colormap will be chosen based on the normalization </span>
<span class="sd">            type. This argument is only used for single-channel data</span>
<span class="sd">            (including when `combine_channels` is True).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_combine_channels</span> <span class="o">=</span> <span class="n">combine_channels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_normalization_type</span> <span class="o">=</span> <span class="n">normalization_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_blur</span> <span class="o">=</span> <span class="n">blur</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_cmap</span> <span class="o">=</span> <span class="n">cmap</span> <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hotcold</span><span class="p">()</span>

    <span class="c1"># TODO(klas): in the future we can allow configuring of tiling settings</span>
    <span class="c1">#   by allowing the user to specify the tiler.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tiler</span> <span class="o">=</span> <span class="n">Tiler</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.path", "search.share", "search.suggest", "toc.follow", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6eac0284.min.js"></script>
      
        <script src="../../../javascript/config.js"></script>
      
        <script src="../../../javascript/app.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../../javascript/tex-mml-chtml-3.0.0.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>