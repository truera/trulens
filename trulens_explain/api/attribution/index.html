
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Evaluate and track LLM applications. Explain Deep Neural Nets.">
      
      
      
      
        <link rel="prev" href="../../attribution_parameterization/">
      
      
        <link rel="next" href="../model_wrappers/">
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.4">
    
    
      
        <title>Attribution - TruLens</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.240905d7.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/cover.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="trulens" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#attribution-methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="TruLens" class="md-header__button md-logo" aria-label="TruLens" data-md-component="logo">
      
  <img src="../../../img/squid.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TruLens
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Attribution
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/truera/trulens" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    truera/trulens
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../welcome/" class="md-tabs__link">
      Welcome to TruLens!
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../trulens_eval/install/" class="md-tabs__link">
        Eval
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../install/" class="md-tabs__link md-tabs__link--active">
        Explain
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="TruLens" class="md-nav__button md-logo" aria-label="TruLens" data-md-component="logo">
      
  <img src="../../../img/squid.png" alt="logo">

    </a>
    TruLens
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/truera/trulens" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    truera/trulens
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../welcome/" class="md-nav__link">
        Welcome to TruLens!
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Eval
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Eval
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/install/" class="md-nav__link">
        üöÄ Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
          ‚ö° Quickstarts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          ‚ö° Quickstarts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/langchain_quickstart/" class="md-nav__link">
        Langchain Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/llama_index_quickstart/" class="md-nav__link">
        Llama-Index Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/text2text_quickstart/" class="md-nav__link">
        Text to Text Quickstart
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Evaluation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Evaluation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
          üéØ Feedback Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          üéØ Feedback Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/function_definitions/" class="md-nav__link">
        Feedback Function Definitions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/feedback_function_guide/" class="md-nav__link">
        Feedback Function Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/custom_feedback_functions/" class="md-nav__link">
        Custom Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_4" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_1_4" id="__nav_3_2_1_4_label" tabindex="0">
          Smoke Tests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_1_4">
          <span class="md-nav__icon md-icon"></span>
          Smoke Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/answer_relevance_smoke_tests/" class="md-nav__link">
        Answer Relevance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/context_relevance_smoke_tests/" class="md-nav__link">
        Context Relevance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
          üìö API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_2">
          <span class="md-nav__icon md-icon"></span>
          üìö API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/feedback/" class="md-nav__link">
        Feedback Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_2" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_2_2" id="__nav_3_2_2_2_label" tabindex="0">
          Providers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_2_2">
          <span class="md-nav__icon md-icon"></span>
          Providers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/openai_provider/" class="md-nav__link">
        OpenAI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/bedrock_provider/" class="md-nav__link">
        AWS Bedrock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/huggingface_provider/" class="md-nav__link">
        HuggingFace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/litellm_provider/" class="md-nav__link">
        LiteLLM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Tracking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Tracking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_1" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0">
          üé∫ Instrumentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          üé∫ Instrumentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/basic_instrumentation/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/langchain_instrumentation/" class="md-nav__link">
        LangChain Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/llama_index_instrumentation/" class="md-nav__link">
        Llama-Index Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
          üöö Logging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          üöö Logging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/where_to_log/" class="md-nav__link">
        Where to Log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/logging/" class="md-nav__link">
        Logging Methods
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
          üìö API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          üìö API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/tru/" class="md-nav__link">
        Tru
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trubasicapp/" class="md-nav__link">
        TruBasicApp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/truchain/" class="md-nav__link">
        TruChain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trullama/" class="md-nav__link">
        TruLlama
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trucustom/" class="md-nav__link">
        TruCustom
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_1" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
          üîç Use Cases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4_1">
          <span class="md-nav__icon md-icon"></span>
          üîç Use Cases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_any/" class="md-nav__link">
        Any LLM App
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_rag/" class="md-nav__link">
        RAGs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_agent/" class="md-nav__link">
        LLM Agents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_production/" class="md-nav__link">
        Dev to Prod
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/CONTRIBUTING/" class="md-nav__link">
        ü§ù Contrbution Guidelines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Explain
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Explain
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        üöÄ Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        ‚ö° Quickstart
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../attribution_parameterization/" class="md-nav__link">
        Attributions
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Attribution
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Attribution
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution" class="md-nav__link">
    trulens_explain.trulens.nn.attribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod" class="md-nav__link">
    AttributionMethod
  </a>
  
    <nav class="md-nav" aria-label="AttributionMethod">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.model" class="md-nav__link">
    model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.attributions" class="md-nav__link">
    attributions()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionResult" class="md-nav__link">
    AttributionResult
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InputAttribution" class="md-nav__link">
    InputAttribution
  </a>
  
    <nav class="md-nav" aria-label="InputAttribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InputAttribution.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.IntegratedGradients" class="md-nav__link">
    IntegratedGradients
  </a>
  
    <nav class="md-nav" aria-label="IntegratedGradients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.IntegratedGradients.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InternalInfluence" class="md-nav__link">
    InternalInfluence
  </a>
  
    <nav class="md-nav" aria-label="InternalInfluence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InternalInfluence.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../model_wrappers/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../slices/" class="md-nav__link">
        Slices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quantities/" class="md-nav__link">
        Quantities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../distributions/" class="md-nav__link">
        Distributions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../visualizations/" class="md-nav__link">
        Visualizations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution" class="md-nav__link">
    trulens_explain.trulens.nn.attribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod" class="md-nav__link">
    AttributionMethod
  </a>
  
    <nav class="md-nav" aria-label="AttributionMethod">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.model" class="md-nav__link">
    model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.attributions" class="md-nav__link">
    attributions()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.AttributionResult" class="md-nav__link">
    AttributionResult
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InputAttribution" class="md-nav__link">
    InputAttribution
  </a>
  
    <nav class="md-nav" aria-label="InputAttribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InputAttribution.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.IntegratedGradients" class="md-nav__link">
    IntegratedGradients
  </a>
  
    <nav class="md-nav" aria-label="IntegratedGradients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.IntegratedGradients.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InternalInfluence" class="md-nav__link">
    InternalInfluence
  </a>
  
    <nav class="md-nav" aria-label="InternalInfluence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.attribution.InternalInfluence.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="attribution-methods">Attribution Methods<a class="headerlink" href="#attribution-methods" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="trulens_explain.trulens.nn.attribution"></a>
  <div class="doc doc-contents first">
  
      <p><em>Attribution methods</em> quantitatively measure the contribution of each of a 
function's individual inputs to its output. Gradient-based attribution methods
compute the gradient of a model with respect to its inputs to describe how
important each input is towards the output prediction. These methods can be
applied to assist in explaining deep networks.</p>
<p>TruLens provides implementations of several such techniques, found in this
package.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.attribution.AttributionMethod" class="doc doc-heading">
        <code>AttributionMethod</code>


<a href="#trulens_explain.trulens.nn.attribution.AttributionMethod" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="abc.ABC">AbstractBaseClass</span></code></p>

  
      <p>Interface used by all attribution methods.</p>
<p>An attribution method takes a neural network model and provides the ability
to assign values to the variables of the network that specify the importance
of each variable towards particular predictions.</p>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AttributionMethod</span><span class="p">(</span><span class="n">AbstractBaseClass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interface used by all attribution methods.</span>

<span class="sd">    An attribution method takes a neural network model and provides the ability</span>
<span class="sd">    to assign values to the variables of the network that specify the importance</span>
<span class="sd">    of each variable towards particular predictions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span> <span class="n">rebatch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract constructor.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            model: ModelWrapper</span>
<span class="sd">                Model for which attributions are calculated.</span>

<span class="sd">            rebatch_size: int (optional)</span>
<span class="sd">                Will rebatch instances to this size if given. This may be</span>
<span class="sd">                required for GPU usage if using a DoI which produces multiple</span>
<span class="sd">                instances per user-provided instance. Many valued DoIs will</span>
<span class="sd">                expand the tensors sent to each layer to original_batch_size *</span>
<span class="sd">                doi_size. The rebatch size will break up original_batch_size *</span>
<span class="sd">                doi_size into rebatch_size chunks to send to model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rebatch_size</span> <span class="o">=</span> <span class="n">rebatch_size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelWrapper</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model for which attributions are calculated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_attributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_inputs</span><span class="p">:</span> <span class="n">ModelInputs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AttributionResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For attributions that have options to return multiple things depending</span>
<span class="sd">        on configuration, wrap those multiple things in the AttributionResult</span>
<span class="sd">        tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">attributions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">model_args</span><span class="p">:</span> <span class="n">ArgsLike</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">:</span> <span class="n">KwargsLike</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">,</span> <span class="n">ArgsLike</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">],</span>
               <span class="n">ArgsLike</span><span class="p">[</span><span class="n">ArgsLike</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns attributions for the given input. Attributions are in the same</span>
<span class="sd">        shape as the layer that attributions are being generated for. </span>

<span class="sd">        The numeric scale of the attributions will depend on the specific</span>
<span class="sd">        implementations of the Distribution of Interest and Quantity of</span>
<span class="sd">        Interest. However it is generally related to the scale of gradients on</span>
<span class="sd">        the Quantity of Interest. </span>

<span class="sd">        For example, Integrated Gradients uses the linear interpolation</span>
<span class="sd">        Distribution of Interest which subsumes the completeness axiom which</span>
<span class="sd">        ensures the sum of all attributions of a record equals the output</span>
<span class="sd">        determined by the Quantity of Interest on the same record. </span>

<span class="sd">        The Point Distribution of Interest will be determined by the gradient at</span>
<span class="sd">        a single point, thus being a good measure of model sensitivity. </span>

<span class="sd">        Parameters:</span>
<span class="sd">            model_args: ArgsLike, model_kwargs: KwargsLike</span>
<span class="sd">                The args and kwargs given to the call method of a model. This</span>
<span class="sd">                should represent the records to obtain attributions for, assumed</span>
<span class="sd">                to be a *batched* input. if `self.model` supports evaluation on</span>
<span class="sd">                *data tensors*, the  appropriate tensor type may be used (e.g.,</span>
<span class="sd">                Pytorch models may accept Pytorch tensors in addition to</span>
<span class="sd">                `np.ndarray`s). The shape of the inputs must match the input</span>
<span class="sd">                shape of `self.model`. </span>

<span class="sd">        Returns</span>
<span class="sd">            - np.ndarray when single attribution_cut input, single qoi output</span>
<span class="sd">            - or ArgsLike[np.ndarray] when single input, multiple output (or</span>
<span class="sd">              vice versa) </span>
<span class="sd">            - or ArgsLike[ArgsLike[np.ndarray]] when multiple output (outer),</span>
<span class="sd">              multiple input (inner)</span>

<span class="sd">            An array of attributions, matching the shape and type of `from_cut`</span>
<span class="sd">            of the slice. Each entry in the returned array represents the degree</span>
<span class="sd">            to which the corresponding feature affected the model&#39;s outcome on</span>
<span class="sd">            the corresponding point.</span>

<span class="sd">            If attributing to a component with multiple inputs, a list for each</span>
<span class="sd">            will be returned.</span>

<span class="sd">            If the quantity of interest features multiple outputs, a list for</span>
<span class="sd">            each will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Calls like: attributions([arg1, arg2]) will get read as model_args =</span>
        <span class="c1"># ([arg1, arg2],), that is, a tuple with a single element containing the</span>
        <span class="c1"># model args. Test below checks for this. TODO: Disallow such</span>
        <span class="c1"># invocations? They should be given as attributions(arg1, arg2).</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_args</span><span class="p">,</span>
                      <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                          <span class="n">model_args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">):</span>
            <span class="n">model_args</span> <span class="o">=</span> <span class="n">model_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">model_inputs</span> <span class="o">=</span> <span class="n">ModelInputs</span><span class="p">(</span>
            <span class="n">args</span><span class="o">=</span><span class="n">many_of_om</span><span class="p">(</span><span class="n">model_args</span><span class="p">),</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">model_kwargs</span>
        <span class="p">)</span>
        <span class="c1"># Will cast results to this data container type.</span>
        <span class="n">return_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_inputs</span><span class="o">.</span><span class="n">first_batchable</span><span class="p">(</span><span class="n">get_backend</span><span class="p">()))</span>

        <span class="n">pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributions</span><span class="p">(</span><span class="n">model_inputs</span><span class="p">)</span>

        <span class="c1"># Format attributions into the public structure which throws out output</span>
        <span class="c1"># lists and input lists if there is only one output or only one input.</span>
        <span class="c1"># Also cast to whatever the input type was.</span>
        <span class="n">attributions</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nested_cast</span><span class="p">(</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">get_backend</span><span class="p">(),</span> <span class="n">astype</span><span class="o">=</span><span class="n">return_type</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">pieces</span><span class="o">.</span><span class="n">attributions</span>
        <span class="p">)</span>
        <span class="n">attributions</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
                             <span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">om_of_many</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attributions</span><span class="p">]</span>
        <span class="n">attributions</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Outputs</span><span class="p">,</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pieces</span><span class="o">.</span><span class="n">gradients</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">pieces</span><span class="o">.</span><span class="n">interventions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tru_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;AttributionMethod configured to return gradients or interventions. &quot;</span>
                <span class="s2">&quot;Use the internal _attribution call to retrieve those.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">attributions</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="trulens_explain.trulens.nn.attribution.AttributionMethod.model" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.model" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Model for which attributions are calculated.</p>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.attribution.AttributionMethod.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">rebatch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Abstract constructor.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="trulens.nn.models._model_base.ModelWrapper">ModelWrapper</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ModelWrapper
Model for which attributions are calculated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rebatch_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>int (optional)
Will rebatch instances to this size if given. This may be
required for GPU usage if using a DoI which produces multiple
instances per user-provided instance. Many valued DoIs will
expand the tensors sent to each layer to original_batch_size *
doi_size. The rebatch size will break up original_batch_size *
doi_size into rebatch_size chunks to send to model.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span> <span class="n">rebatch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract constructor.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model: ModelWrapper</span>
<span class="sd">            Model for which attributions are calculated.</span>

<span class="sd">        rebatch_size: int (optional)</span>
<span class="sd">            Will rebatch instances to this size if given. This may be</span>
<span class="sd">            required for GPU usage if using a DoI which produces multiple</span>
<span class="sd">            instances per user-provided instance. Many valued DoIs will</span>
<span class="sd">            expand the tensors sent to each layer to original_batch_size *</span>
<span class="sd">            doi_size. The rebatch size will break up original_batch_size *</span>
<span class="sd">            doi_size into rebatch_size chunks to send to model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rebatch_size</span> <span class="o">=</span> <span class="n">rebatch_size</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.attribution.AttributionMethod.attributions" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">attributions</span><span class="p">(</span><span class="o">*</span><span class="n">model_args</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.attribution.AttributionMethod.attributions" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns attributions for the given input. Attributions are in the same
shape as the layer that attributions are being generated for. </p>
<p>The numeric scale of the attributions will depend on the specific
implementations of the Distribution of Interest and Quantity of
Interest. However it is generally related to the scale of gradients on
the Quantity of Interest. </p>
<p>For example, Integrated Gradients uses the linear interpolation
Distribution of Interest which subsumes the completeness axiom which
ensures the sum of all attributions of a record equals the output
determined by the Quantity of Interest on the same record. </p>
<p>The Point Distribution of Interest will be determined by the gradient at
a single point, thus being a good measure of model sensitivity. </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model_args</code></td>
          <td>
                <code><span title="trulens.utils.typing.ArgsLike">ArgsLike</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ArgsLike, model_kwargs: KwargsLike
The args and kwargs given to the call method of a model. This
should represent the records to obtain attributions for, assumed
to be a <em>batched</em> input. if <code>self.model</code> supports evaluation on
<em>data tensors</em>, the  appropriate tensor type may be used (e.g.,
Pytorch models may accept Pytorch tensors in addition to
<code>np.ndarray</code>s). The shape of the inputs must match the input
shape of <code>self.model</code>. </p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns
    - np.ndarray when single attribution_cut input, single qoi output
    - or ArgsLike[np.ndarray] when single input, multiple output (or
      vice versa) 
    - or ArgsLike[ArgsLike[np.ndarray]] when multiple output (outer),
      multiple input (inner)</p>
<div class="codehilite"><pre><span></span><code>An array of attributions, matching the shape and type of `from_cut`
of the slice. Each entry in the returned array represents the degree
to which the corresponding feature affected the model&#39;s outcome on
the corresponding point.

If attributing to a component with multiple inputs, a list for each
will be returned.

If the quantity of interest features multiple outputs, a list for
each will be returned.
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">attributions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">model_args</span><span class="p">:</span> <span class="n">ArgsLike</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">:</span> <span class="n">KwargsLike</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">,</span> <span class="n">ArgsLike</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">],</span>
           <span class="n">ArgsLike</span><span class="p">[</span><span class="n">ArgsLike</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns attributions for the given input. Attributions are in the same</span>
<span class="sd">    shape as the layer that attributions are being generated for. </span>

<span class="sd">    The numeric scale of the attributions will depend on the specific</span>
<span class="sd">    implementations of the Distribution of Interest and Quantity of</span>
<span class="sd">    Interest. However it is generally related to the scale of gradients on</span>
<span class="sd">    the Quantity of Interest. </span>

<span class="sd">    For example, Integrated Gradients uses the linear interpolation</span>
<span class="sd">    Distribution of Interest which subsumes the completeness axiom which</span>
<span class="sd">    ensures the sum of all attributions of a record equals the output</span>
<span class="sd">    determined by the Quantity of Interest on the same record. </span>

<span class="sd">    The Point Distribution of Interest will be determined by the gradient at</span>
<span class="sd">    a single point, thus being a good measure of model sensitivity. </span>

<span class="sd">    Parameters:</span>
<span class="sd">        model_args: ArgsLike, model_kwargs: KwargsLike</span>
<span class="sd">            The args and kwargs given to the call method of a model. This</span>
<span class="sd">            should represent the records to obtain attributions for, assumed</span>
<span class="sd">            to be a *batched* input. if `self.model` supports evaluation on</span>
<span class="sd">            *data tensors*, the  appropriate tensor type may be used (e.g.,</span>
<span class="sd">            Pytorch models may accept Pytorch tensors in addition to</span>
<span class="sd">            `np.ndarray`s). The shape of the inputs must match the input</span>
<span class="sd">            shape of `self.model`. </span>

<span class="sd">    Returns</span>
<span class="sd">        - np.ndarray when single attribution_cut input, single qoi output</span>
<span class="sd">        - or ArgsLike[np.ndarray] when single input, multiple output (or</span>
<span class="sd">          vice versa) </span>
<span class="sd">        - or ArgsLike[ArgsLike[np.ndarray]] when multiple output (outer),</span>
<span class="sd">          multiple input (inner)</span>

<span class="sd">        An array of attributions, matching the shape and type of `from_cut`</span>
<span class="sd">        of the slice. Each entry in the returned array represents the degree</span>
<span class="sd">        to which the corresponding feature affected the model&#39;s outcome on</span>
<span class="sd">        the corresponding point.</span>

<span class="sd">        If attributing to a component with multiple inputs, a list for each</span>
<span class="sd">        will be returned.</span>

<span class="sd">        If the quantity of interest features multiple outputs, a list for</span>
<span class="sd">        each will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Calls like: attributions([arg1, arg2]) will get read as model_args =</span>
    <span class="c1"># ([arg1, arg2],), that is, a tuple with a single element containing the</span>
    <span class="c1"># model args. Test below checks for this. TODO: Disallow such</span>
    <span class="c1"># invocations? They should be given as attributions(arg1, arg2).</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_args</span><span class="p">,</span>
                  <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                      <span class="n">model_args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">):</span>
        <span class="n">model_args</span> <span class="o">=</span> <span class="n">model_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">model_inputs</span> <span class="o">=</span> <span class="n">ModelInputs</span><span class="p">(</span>
        <span class="n">args</span><span class="o">=</span><span class="n">many_of_om</span><span class="p">(</span><span class="n">model_args</span><span class="p">),</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">model_kwargs</span>
    <span class="p">)</span>
    <span class="c1"># Will cast results to this data container type.</span>
    <span class="n">return_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_inputs</span><span class="o">.</span><span class="n">first_batchable</span><span class="p">(</span><span class="n">get_backend</span><span class="p">()))</span>

    <span class="n">pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributions</span><span class="p">(</span><span class="n">model_inputs</span><span class="p">)</span>

    <span class="c1"># Format attributions into the public structure which throws out output</span>
    <span class="c1"># lists and input lists if there is only one output or only one input.</span>
    <span class="c1"># Also cast to whatever the input type was.</span>
    <span class="n">attributions</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nested_cast</span><span class="p">(</span>
        <span class="n">backend</span><span class="o">=</span><span class="n">get_backend</span><span class="p">(),</span> <span class="n">astype</span><span class="o">=</span><span class="n">return_type</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">pieces</span><span class="o">.</span><span class="n">attributions</span>
    <span class="p">)</span>
    <span class="n">attributions</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
                         <span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">om_of_many</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attributions</span><span class="p">]</span>
    <span class="n">attributions</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Outputs</span><span class="p">,</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span>
                                 <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">attributions</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pieces</span><span class="o">.</span><span class="n">gradients</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">pieces</span><span class="o">.</span><span class="n">interventions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tru_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;AttributionMethod configured to return gradients or interventions. &quot;</span>
            <span class="s2">&quot;Use the internal _attribution call to retrieve those.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">attributions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.attribution.AttributionResult" class="doc doc-heading">
        <code>AttributionResult</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#trulens_explain.trulens.nn.attribution.AttributionResult" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>_attribution method output container.</p>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AttributionResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    _attribution method output container.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">attributions</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gradients</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">interventions</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.attribution.InputAttribution" class="doc doc-heading">
        <code>InputAttribution</code>


<a href="#trulens_explain.trulens.nn.attribution.InputAttribution" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.nn.attribution.InternalInfluence" href="#trulens_explain.trulens.nn.attribution.InternalInfluence">InternalInfluence</a></code></p>

  
      <p>Attributions of input features on either internal or output quantities. This
is essentially an alias for</p>
<div class="highlight"><pre><span></span><code><span class="n">InternalInfluence</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">(</span><span class="n">trulens</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">slices</span><span class="o">.</span><span class="n">InputCut</span><span class="p">(),</span> <span class="n">cut</span><span class="p">),</span>
    <span class="n">qoi</span><span class="p">,</span>
    <span class="n">doi</span><span class="p">,</span>
    <span class="n">multiply_activation</span><span class="p">)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InputAttribution</span><span class="p">(</span><span class="n">InternalInfluence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributions of input features on either internal or output quantities. This</span>
<span class="sd">    is essentially an alias for</span>

<span class="sd">    ```python</span>
<span class="sd">    InternalInfluence(</span>
<span class="sd">        model,</span>
<span class="sd">        (trulens.nn.slices.InputCut(), cut),</span>
<span class="sd">        qoi,</span>
<span class="sd">        doi,</span>
<span class="sd">        multiply_activation)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
        <span class="n">qoi_cut</span><span class="p">:</span> <span class="n">CutLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
        <span class="n">qoi</span><span class="p">:</span> <span class="n">QoiLike</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span>
        <span class="n">doi_cut</span><span class="p">:</span> <span class="n">CutLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
        <span class="n">doi</span><span class="p">:</span> <span class="n">DoiLike</span> <span class="o">=</span> <span class="s1">&#39;point&#39;</span><span class="p">,</span>
        <span class="n">multiply_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">            model :</span>
<span class="sd">                Model for which attributions are calculated.</span>

<span class="sd">            qoi_cut :</span>
<span class="sd">                The cut determining the layer from which the QoI is derived.</span>
<span class="sd">                Expects a `Cut` object, or a related type that can be</span>
<span class="sd">                interpreted as a `Cut`, as documented below.</span>

<span class="sd">                If an `int` is given, it represents the index of a layer in</span>
<span class="sd">                `model`. </span>

<span class="sd">                If a `str` is given, it represents the name of a layer in</span>
<span class="sd">                `model`. </span>

<span class="sd">                `None` is an alternative for `slices.OutputCut()`.</span>

<span class="sd">            qoi : quantities.QoI | int | tuple | str</span>
<span class="sd">                Quantity of interest to attribute. Expects a `QoI` object, or a</span>
<span class="sd">                related type that can be interpreted as a `QoI`, as documented</span>
<span class="sd">                below.</span>

<span class="sd">                If an `int` is given, the quantity of interest is taken to be</span>
<span class="sd">                the slice output for the class/neuron/channel specified by the</span>
<span class="sd">                given integer, i.e., ```python</span>
<span class="sd">                quantities.InternalChannelQoI(qoi) ```</span>

<span class="sd">                If a tuple or list of two integers is given, then the quantity</span>
<span class="sd">                of interest is taken to be the comparative quantity for the</span>
<span class="sd">                class given by the first integer against the class given by the</span>
<span class="sd">                second integer, i.e., ```python quantities.ComparativeQoI(*qoi)</span>
<span class="sd">                ```</span>

<span class="sd">                If a callable is given, it is interpreted as a function</span>
<span class="sd">                representing the QoI, i.e., ```python quantities.LambdaQoI(qoi)</span>
<span class="sd">                ```</span>

<span class="sd">                If the string, `&#39;max&#39;`, is given, the quantity of interest is</span>
<span class="sd">                taken to be the output for the class with the maximum score,</span>
<span class="sd">                i.e., ```python quantities.MaxClassQoI() ```</span>

<span class="sd">            doi_cut :</span>
<span class="sd">                For models which have non-differentiable pre-processing at the</span>
<span class="sd">                start of the model, specify the cut of the initial</span>
<span class="sd">                differentiable input form. For NLP models, for example, this</span>
<span class="sd">                could point to the embedding layer. If not provided, InputCut is</span>
<span class="sd">                assumed.</span>

<span class="sd">            doi : distributions.DoI | str</span>
<span class="sd">                Distribution of interest over inputs. Expects a `DoI` object, or</span>
<span class="sd">                a related type that can be interpreted as a `DoI`, as documented</span>
<span class="sd">                below.</span>

<span class="sd">                If the string, `&#39;point&#39;`, is given, the distribution is taken to</span>
<span class="sd">                be the single point passed to `attributions`, i.e., ```python</span>
<span class="sd">                distributions.PointDoi() ```</span>

<span class="sd">                If the string, `&#39;linear&#39;`, is given, the distribution is taken</span>
<span class="sd">                to be the linear interpolation from the zero input to the point</span>
<span class="sd">                passed to `attributions`, i.e., ```python</span>
<span class="sd">                distributions.LinearDoi() ```</span>

<span class="sd">            multiply_activation : bool, optional</span>
<span class="sd">                Whether to multiply the gradient result by its corresponding</span>
<span class="sd">                activation, thus converting from &quot;*influence space*&quot; to</span>
<span class="sd">                &quot;*attribution space*.&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">doi_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># WARNING-LOAD-INIT: Do not put this as a default arg in the def</span>
            <span class="c1"># line. That would cause an instantiation of InputCut when this</span>
            <span class="c1"># class is loaded and before it is used. Because get_backend gets</span>
            <span class="c1"># called in Cut.__init__, it may fail if this class is loaded before</span>
            <span class="c1"># trulens.nn.models.get_model_wrapper is called on some model.</span>
            <span class="n">doi_cut</span> <span class="o">=</span> <span class="n">InputCut</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="n">doi_cut</span><span class="p">,</span> <span class="n">qoi_cut</span><span class="p">),</span>
            <span class="n">qoi</span><span class="p">,</span>
            <span class="n">doi</span><span class="p">,</span>
            <span class="n">multiply_activation</span><span class="o">=</span><span class="n">multiply_activation</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.attribution.InputAttribution.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">qoi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qoi</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">doi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;point&#39;</span><span class="p">,</span> <span class="n">multiply_activation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.attribution.InputAttribution.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model for which attributions are calculated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>qoi_cut</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The cut determining the layer from which the QoI is derived.
Expects a <code>Cut</code> object, or a related type that can be
interpreted as a <code>Cut</code>, as documented below.</p>
<p>If an <code>int</code> is given, it represents the index of a layer in
<code>model</code>. </p>
<p>If a <code>str</code> is given, it represents the name of a layer in
<code>model</code>. </p>
<p><code>None</code> is an alternative for <code>slices.OutputCut()</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>qoi</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>quantities.QoI | int | tuple | str
Quantity of interest to attribute. Expects a <code>QoI</code> object, or a
related type that can be interpreted as a <code>QoI</code>, as documented
below.</p>
<p>If an <code>int</code> is given, the quantity of interest is taken to be
the slice output for the class/neuron/channel specified by the
given integer, i.e., <code>python
quantities.InternalChannelQoI(qoi)</code></p>
<p>If a tuple or list of two integers is given, then the quantity
of interest is taken to be the comparative quantity for the
class given by the first integer against the class given by the
second integer, i.e., ```python quantities.ComparativeQoI(*qoi)
<div class="highlight"><pre><span></span><code>If a callable is given, it is interpreted as a function
representing the QoI, i.e., ```python quantities.LambdaQoI(qoi)
</code></pre></div></p>
<p>If the string, <code>'max'</code>, is given, the quantity of interest is
taken to be the output for the class with the maximum score,
i.e., <code>python quantities.MaxClassQoI()</code></p>
            </div>
          </td>
          <td>
                <code>&#39;max&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>doi_cut</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For models which have non-differentiable pre-processing at the
start of the model, specify the cut of the initial
differentiable input form. For NLP models, for example, this
could point to the embedding layer. If not provided, InputCut is
assumed.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>doi</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>distributions.DoI | str
Distribution of interest over inputs. Expects a <code>DoI</code> object, or
a related type that can be interpreted as a <code>DoI</code>, as documented
below.</p>
<p>If the string, <code>'point'</code>, is given, the distribution is taken to
be the single point passed to <code>attributions</code>, i.e., <code>python
distributions.PointDoi()</code></p>
<p>If the string, <code>'linear'</code>, is given, the distribution is taken
to be the linear interpolation from the zero input to the point
passed to <code>attributions</code>, i.e., <code>python
distributions.LinearDoi()</code></p>
            </div>
          </td>
          <td>
                <code>&#39;point&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>multiply_activation</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>bool, optional
Whether to multiply the gradient result by its corresponding
activation, thus converting from "<em>influence space</em>" to
"<em>attribution space</em>."</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
    <span class="n">qoi_cut</span><span class="p">:</span> <span class="n">CutLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
    <span class="n">qoi</span><span class="p">:</span> <span class="n">QoiLike</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span>
    <span class="n">doi_cut</span><span class="p">:</span> <span class="n">CutLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
    <span class="n">doi</span><span class="p">:</span> <span class="n">DoiLike</span> <span class="o">=</span> <span class="s1">&#39;point&#39;</span><span class="p">,</span>
    <span class="n">multiply_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters:</span>
<span class="sd">        model :</span>
<span class="sd">            Model for which attributions are calculated.</span>

<span class="sd">        qoi_cut :</span>
<span class="sd">            The cut determining the layer from which the QoI is derived.</span>
<span class="sd">            Expects a `Cut` object, or a related type that can be</span>
<span class="sd">            interpreted as a `Cut`, as documented below.</span>

<span class="sd">            If an `int` is given, it represents the index of a layer in</span>
<span class="sd">            `model`. </span>

<span class="sd">            If a `str` is given, it represents the name of a layer in</span>
<span class="sd">            `model`. </span>

<span class="sd">            `None` is an alternative for `slices.OutputCut()`.</span>

<span class="sd">        qoi : quantities.QoI | int | tuple | str</span>
<span class="sd">            Quantity of interest to attribute. Expects a `QoI` object, or a</span>
<span class="sd">            related type that can be interpreted as a `QoI`, as documented</span>
<span class="sd">            below.</span>

<span class="sd">            If an `int` is given, the quantity of interest is taken to be</span>
<span class="sd">            the slice output for the class/neuron/channel specified by the</span>
<span class="sd">            given integer, i.e., ```python</span>
<span class="sd">            quantities.InternalChannelQoI(qoi) ```</span>

<span class="sd">            If a tuple or list of two integers is given, then the quantity</span>
<span class="sd">            of interest is taken to be the comparative quantity for the</span>
<span class="sd">            class given by the first integer against the class given by the</span>
<span class="sd">            second integer, i.e., ```python quantities.ComparativeQoI(*qoi)</span>
<span class="sd">            ```</span>

<span class="sd">            If a callable is given, it is interpreted as a function</span>
<span class="sd">            representing the QoI, i.e., ```python quantities.LambdaQoI(qoi)</span>
<span class="sd">            ```</span>

<span class="sd">            If the string, `&#39;max&#39;`, is given, the quantity of interest is</span>
<span class="sd">            taken to be the output for the class with the maximum score,</span>
<span class="sd">            i.e., ```python quantities.MaxClassQoI() ```</span>

<span class="sd">        doi_cut :</span>
<span class="sd">            For models which have non-differentiable pre-processing at the</span>
<span class="sd">            start of the model, specify the cut of the initial</span>
<span class="sd">            differentiable input form. For NLP models, for example, this</span>
<span class="sd">            could point to the embedding layer. If not provided, InputCut is</span>
<span class="sd">            assumed.</span>

<span class="sd">        doi : distributions.DoI | str</span>
<span class="sd">            Distribution of interest over inputs. Expects a `DoI` object, or</span>
<span class="sd">            a related type that can be interpreted as a `DoI`, as documented</span>
<span class="sd">            below.</span>

<span class="sd">            If the string, `&#39;point&#39;`, is given, the distribution is taken to</span>
<span class="sd">            be the single point passed to `attributions`, i.e., ```python</span>
<span class="sd">            distributions.PointDoi() ```</span>

<span class="sd">            If the string, `&#39;linear&#39;`, is given, the distribution is taken</span>
<span class="sd">            to be the linear interpolation from the zero input to the point</span>
<span class="sd">            passed to `attributions`, i.e., ```python</span>
<span class="sd">            distributions.LinearDoi() ```</span>

<span class="sd">        multiply_activation : bool, optional</span>
<span class="sd">            Whether to multiply the gradient result by its corresponding</span>
<span class="sd">            activation, thus converting from &quot;*influence space*&quot; to</span>
<span class="sd">            &quot;*attribution space*.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">doi_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># WARNING-LOAD-INIT: Do not put this as a default arg in the def</span>
        <span class="c1"># line. That would cause an instantiation of InputCut when this</span>
        <span class="c1"># class is loaded and before it is used. Because get_backend gets</span>
        <span class="c1"># called in Cut.__init__, it may fail if this class is loaded before</span>
        <span class="c1"># trulens.nn.models.get_model_wrapper is called on some model.</span>
        <span class="n">doi_cut</span> <span class="o">=</span> <span class="n">InputCut</span><span class="p">()</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="n">doi_cut</span><span class="p">,</span> <span class="n">qoi_cut</span><span class="p">),</span>
        <span class="n">qoi</span><span class="p">,</span>
        <span class="n">doi</span><span class="p">,</span>
        <span class="n">multiply_activation</span><span class="o">=</span><span class="n">multiply_activation</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.attribution.IntegratedGradients" class="doc doc-heading">
        <code>IntegratedGradients</code>


<a href="#trulens_explain.trulens.nn.attribution.IntegratedGradients" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.nn.attribution.InputAttribution" href="#trulens_explain.trulens.nn.attribution.InputAttribution">InputAttribution</a></code></p>

  
      <p>Implementation for the Integrated Gradients method from the following paper:</p>
<p><a href="https://arxiv.org/pdf/1703.01365">Axiomatic Attribution for Deep Networks</a></p>
<p>This should be cited using:</p>
<div class="highlight"><pre><span></span><code><span class="nc">@INPROCEEDINGS</span><span class="p">{</span>
<span class="w">    </span><span class="nl">sundararajan17axiomatic</span><span class="p">,</span>
<span class="w">    </span><span class="na">author</span><span class="p">=</span><span class="s">{Mukund Sundararajan and Ankur Taly, and Qiqi Yan}</span><span class="p">,</span>
<span class="w">    </span><span class="na">title</span><span class="p">=</span><span class="s">{Axiomatic Attribution for Deep Networks}</span><span class="p">,</span>
<span class="w">    </span><span class="na">booktitle</span><span class="p">=</span><span class="s">{International Conference on Machine Learning (ICML)}</span><span class="p">,</span>
<span class="w">    </span><span class="na">year</span><span class="p">=</span><span class="s">{2017}</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<p>This is essentially an alias for</p>
<div class="highlight"><pre><span></span><code><span class="n">InternalInfluence</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">(</span><span class="n">trulens</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">slices</span><span class="o">.</span><span class="n">InputCut</span><span class="p">(),</span> <span class="n">trulens</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">slices</span><span class="o">.</span><span class="n">OutputCut</span><span class="p">()),</span>
    <span class="s1">&#39;max&#39;</span><span class="p">,</span>
    <span class="n">trulens</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">LinearDoi</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">resolution</span><span class="p">),</span>
    <span class="n">multiply_activation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IntegratedGradients</span><span class="p">(</span><span class="n">InputAttribution</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implementation for the Integrated Gradients method from the following paper:</span>

<span class="sd">    [Axiomatic Attribution for Deep Networks](</span>
<span class="sd">        https://arxiv.org/pdf/1703.01365)</span>

<span class="sd">    This should be cited using:</span>

<span class="sd">    ```bibtex</span>
<span class="sd">    @INPROCEEDINGS{</span>
<span class="sd">        sundararajan17axiomatic,</span>
<span class="sd">        author={Mukund Sundararajan and Ankur Taly, and Qiqi Yan},</span>
<span class="sd">        title={Axiomatic Attribution for Deep Networks},</span>
<span class="sd">        booktitle={International Conference on Machine Learning (ICML)},</span>
<span class="sd">        year={2017},</span>
<span class="sd">    }</span>
<span class="sd">    ```</span>

<span class="sd">    This is essentially an alias for</span>

<span class="sd">    ```python</span>
<span class="sd">    InternalInfluence(</span>
<span class="sd">        model,</span>
<span class="sd">        (trulens.nn.slices.InputCut(), trulens.nn.slices.OutputCut()),</span>
<span class="sd">        &#39;max&#39;,</span>
<span class="sd">        trulens.nn.distributions.LinearDoi(baseline, resolution),</span>
<span class="sd">        multiply_activation=True)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
        <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resolution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
        <span class="n">doi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
        <span class="n">qoi</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
        <span class="n">qoi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">            model:</span>
<span class="sd">                Model for which attributions are calculated.</span>

<span class="sd">            baseline:</span>
<span class="sd">                The baseline to interpolate from. Must be same shape as the </span>
<span class="sd">                input. If `None` is given, the zero vector in the appropriate </span>
<span class="sd">                shape will be used.</span>

<span class="sd">            resolution:</span>
<span class="sd">                Number of points to use in the approximation. A higher </span>
<span class="sd">                resolution is more computationally expensive, but gives a better</span>
<span class="sd">                approximation of the mathematical formula this attribution </span>
<span class="sd">                method represents.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">doi_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">doi_cut</span> <span class="o">=</span> <span class="n">InputCut</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">qoi_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">qoi_cut</span> <span class="o">=</span> <span class="n">OutputCut</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">qoi_cut</span><span class="o">=</span><span class="n">qoi_cut</span><span class="p">,</span>
            <span class="n">qoi</span><span class="o">=</span><span class="n">qoi</span><span class="p">,</span>
            <span class="n">doi_cut</span><span class="o">=</span><span class="n">doi_cut</span><span class="p">,</span>
            <span class="n">doi</span><span class="o">=</span><span class="n">LinearDoi</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="n">doi_cut</span><span class="p">),</span>
            <span class="n">multiply_activation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.attribution.IntegratedGradients.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">doi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qoi</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">qoi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.attribution.IntegratedGradients.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="trulens.nn.models._model_base.ModelWrapper">ModelWrapper</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model for which attributions are calculated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>baseline</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The baseline to interpolate from. Must be same shape as the 
input. If <code>None</code> is given, the zero vector in the appropriate 
shape will be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>resolution</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of points to use in the approximation. A higher 
resolution is more computationally expensive, but gives a better
approximation of the mathematical formula this attribution 
method represents.</p>
            </div>
          </td>
          <td>
                <code>50</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
    <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">doi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
    <span class="n">qoi</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
    <span class="n">qoi_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># see WARNING-LOAD-INIT</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters:</span>
<span class="sd">        model:</span>
<span class="sd">            Model for which attributions are calculated.</span>

<span class="sd">        baseline:</span>
<span class="sd">            The baseline to interpolate from. Must be same shape as the </span>
<span class="sd">            input. If `None` is given, the zero vector in the appropriate </span>
<span class="sd">            shape will be used.</span>

<span class="sd">        resolution:</span>
<span class="sd">            Number of points to use in the approximation. A higher </span>
<span class="sd">            resolution is more computationally expensive, but gives a better</span>
<span class="sd">            approximation of the mathematical formula this attribution </span>
<span class="sd">            method represents.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">doi_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">doi_cut</span> <span class="o">=</span> <span class="n">InputCut</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">qoi_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">qoi_cut</span> <span class="o">=</span> <span class="n">OutputCut</span><span class="p">()</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">qoi_cut</span><span class="o">=</span><span class="n">qoi_cut</span><span class="p">,</span>
        <span class="n">qoi</span><span class="o">=</span><span class="n">qoi</span><span class="p">,</span>
        <span class="n">doi_cut</span><span class="o">=</span><span class="n">doi_cut</span><span class="p">,</span>
        <span class="n">doi</span><span class="o">=</span><span class="n">LinearDoi</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="n">doi_cut</span><span class="p">),</span>
        <span class="n">multiply_activation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.attribution.InternalInfluence" class="doc doc-heading">
        <code>InternalInfluence</code>


<a href="#trulens_explain.trulens.nn.attribution.InternalInfluence" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.nn.attribution.AttributionMethod" href="#trulens_explain.trulens.nn.attribution.AttributionMethod">AttributionMethod</a></code></p>

  
      <p>Internal attributions parameterized by a slice, quantity of interest, and
distribution of interest.</p>
<p>The <em>slice</em> specifies the layers at which the internals of the model are to
be exposed; it is represented by two <em>cuts</em>, which specify the layer the
attributions are assigned to and the layer from which the quantity of
interest is derived. The <em>Quantity of Interest</em> (QoI) is a function of the
output specified by the slice that determines the network output behavior
that the attributions are to describe. The <em>Distribution of Interest</em> (DoI)
specifies the records over which the attributions are aggregated.</p>
<p>More information can be found in the following paper:</p>
<p><a href="https://arxiv.org/pdf/1802.03788.pdf">Influence-Directed Explanations for Deep Convolutional Networks</a></p>
<p>This should be cited using:</p>
<div class="highlight"><pre><span></span><code><span class="nc">@INPROCEEDINGS</span><span class="p">{</span>
<span class="w">    </span><span class="nl">leino18influence</span><span class="p">,</span>
<span class="w">    </span><span class="na">author</span><span class="p">=</span><span class="s">{</span>
<span class="s">        Klas Leino and</span>
<span class="s">        Shayak Sen and</span>
<span class="s">        Anupam Datta and</span>
<span class="s">        Matt Fredrikson and</span>
<span class="s">        Linyi Li}</span><span class="p">,</span>
<span class="w">    </span><span class="na">title</span><span class="p">=</span><span class="s">{</span>
<span class="s">        Influence-Directed Explanations</span>
<span class="s">        for Deep Convolutional Networks}</span><span class="p">,</span>
<span class="w">    </span><span class="na">booktitle</span><span class="p">=</span><span class="s">{IEEE International Test Conference (ITC)}</span><span class="p">,</span>
<span class="w">    </span><span class="na">year</span><span class="p">=</span><span class="s">{2018}</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InternalInfluence</span><span class="p">(</span><span class="n">AttributionMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Internal attributions parameterized by a slice, quantity of interest, and</span>
<span class="sd">    distribution of interest.</span>

<span class="sd">    The *slice* specifies the layers at which the internals of the model are to</span>
<span class="sd">    be exposed; it is represented by two *cuts*, which specify the layer the</span>
<span class="sd">    attributions are assigned to and the layer from which the quantity of</span>
<span class="sd">    interest is derived. The *Quantity of Interest* (QoI) is a function of the</span>
<span class="sd">    output specified by the slice that determines the network output behavior</span>
<span class="sd">    that the attributions are to describe. The *Distribution of Interest* (DoI)</span>
<span class="sd">    specifies the records over which the attributions are aggregated.</span>

<span class="sd">    More information can be found in the following paper:</span>

<span class="sd">    [Influence-Directed Explanations for Deep Convolutional Networks](</span>
<span class="sd">        https://arxiv.org/pdf/1802.03788.pdf)</span>

<span class="sd">    This should be cited using:</span>

<span class="sd">    ```bibtex</span>
<span class="sd">    @INPROCEEDINGS{</span>
<span class="sd">        leino18influence,</span>
<span class="sd">        author={</span>
<span class="sd">            Klas Leino and</span>
<span class="sd">            Shayak Sen and</span>
<span class="sd">            Anupam Datta and</span>
<span class="sd">            Matt Fredrikson and</span>
<span class="sd">            Linyi Li},</span>
<span class="sd">        title={</span>
<span class="sd">            Influence-Directed Explanations</span>
<span class="sd">            for Deep Convolutional Networks},</span>
<span class="sd">        booktitle={IEEE International Test Conference (ITC)},</span>
<span class="sd">        year={2018},</span>
<span class="sd">    }</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
        <span class="n">cuts</span><span class="p">:</span> <span class="n">SliceLike</span><span class="p">,</span>
        <span class="n">qoi</span><span class="p">:</span> <span class="n">QoiLike</span><span class="p">,</span>
        <span class="n">doi</span><span class="p">:</span> <span class="n">DoiLike</span><span class="p">,</span>
        <span class="n">multiply_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_grads</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_doi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">            model:</span>
<span class="sd">                Model for which attributions are calculated.</span>

<span class="sd">            cuts: </span>
<span class="sd">                The slice to use when computing the attributions. The slice </span>
<span class="sd">                keeps track of the layer whose output attributions are </span>
<span class="sd">                calculated and the layer for which the quantity of interest is </span>
<span class="sd">                computed. Expects a `Slice` object, or a related type that can</span>
<span class="sd">                be interpreted as a `Slice`, as documented below.</span>

<span class="sd">                If a single `Cut` object is given, it is assumed to be the cut </span>
<span class="sd">                representing the layer for which attributions are calculated </span>
<span class="sd">                (i.e., `from_cut` in `Slice`) and the layer for the quantity of </span>
<span class="sd">                interest (i.e., `to_cut` in `slices.Slice`) is taken to be the </span>
<span class="sd">                output of the network. If a tuple or list of two `Cut`s is </span>
<span class="sd">                given, they are assumed to be `from_cut` and `to_cut`, </span>
<span class="sd">                respectively.</span>

<span class="sd">                A cut (or the cuts within the tuple) can also be represented as </span>
<span class="sd">                an `int`, `str`, or `None`. If an `int` is given, it represents </span>
<span class="sd">                the index of a layer in `model`. If a `str` is given, it </span>
<span class="sd">                represents the name of a layer in `model`. `None` is an </span>
<span class="sd">                alternative for `slices.InputCut`.</span>

<span class="sd">            qoi:</span>
<span class="sd">                Quantity of interest to attribute. Expects a `QoI` object, or a</span>
<span class="sd">                related type that can be interpreted as a `QoI`, as documented</span>
<span class="sd">                below.</span>

<span class="sd">                If an `int` is given, the quantity of interest is taken to be </span>
<span class="sd">                the slice output for the class/neuron/channel specified by the </span>
<span class="sd">                given integer, i.e., </span>
<span class="sd">                ```python</span>
<span class="sd">                quantities.InternalChannelQoI(qoi)</span>
<span class="sd">                ```</span>

<span class="sd">                If a tuple or list of two integers is given, then the quantity </span>
<span class="sd">                of interest is taken to be the comparative quantity for the </span>
<span class="sd">                class given by the first integer against the class given by the </span>
<span class="sd">                second integer, i.e., </span>
<span class="sd">                ```python</span>
<span class="sd">                quantities.ComparativeQoI(*qoi)</span>
<span class="sd">                ```</span>

<span class="sd">                If a callable is given, it is interpreted as a function</span>
<span class="sd">                representing the QoI, i.e.,</span>
<span class="sd">                ```python</span>
<span class="sd">                quantities.LambdaQoI(qoi)</span>
<span class="sd">                ```</span>

<span class="sd">                If the string, `&#39;max&#39;`, is given, the quantity of interest is </span>
<span class="sd">                taken to be the output for the class with the maximum score, </span>
<span class="sd">                i.e., </span>
<span class="sd">                ```python</span>
<span class="sd">                quantities.MaxClassQoI()</span>
<span class="sd">                ```</span>

<span class="sd">            doi:</span>
<span class="sd">                Distribution of interest over inputs. Expects a `DoI` object, or</span>
<span class="sd">                a related type that can be interpreted as a `DoI`, as documented</span>
<span class="sd">                below.</span>

<span class="sd">                If the string, `&#39;point&#39;`, is given, the distribution is taken to</span>
<span class="sd">                be the single point passed to `attributions`, i.e., </span>
<span class="sd">                ```python</span>
<span class="sd">                distributions.PointDoi()</span>
<span class="sd">                ```</span>

<span class="sd">                If the string, `&#39;linear&#39;`, is given, the distribution is taken </span>
<span class="sd">                to be the linear interpolation from the zero input to the point </span>
<span class="sd">                passed to `attributions`, i.e., </span>
<span class="sd">                ```python</span>
<span class="sd">                distributions.LinearDoi()</span>
<span class="sd">                ```</span>

<span class="sd">            multiply_activation:</span>
<span class="sd">                Whether to multiply the gradient result by its corresponding</span>
<span class="sd">                activation, thus converting from &quot;*influence space*&quot; to </span>
<span class="sd">                &quot;*attribution space*.&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">slice</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_slice</span><span class="p">(</span><span class="n">cuts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qoi</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_qoi</span><span class="p">(</span><span class="n">qoi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_doi</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">from_cut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_multiply</span> <span class="o">=</span> <span class="n">multiply_activation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_return_grads</span> <span class="o">=</span> <span class="n">return_grads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_return_doi</span> <span class="o">=</span> <span class="n">return_doi</span>

    <span class="k">def</span> <span class="nf">_attributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_inputs</span><span class="p">:</span> <span class="n">ModelInputs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AttributionResult</span><span class="p">:</span>
        <span class="c1"># NOTE: not symbolic</span>

        <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">AttributionResult</span><span class="p">()</span>

        <span class="c1"># Create a message for out-of-memory errors regarding float and batch size.</span>
        <span class="n">first_batchable</span> <span class="o">=</span> <span class="n">model_inputs</span><span class="o">.</span><span class="n">first_batchable</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">first_batchable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="n">first_batchable</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">param_msgs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;float size = </span><span class="si">{</span><span class="n">B</span><span class="o">.</span><span class="n">floatX_size</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">B</span><span class="o">.</span><span class="n">floatX</span><span class="si">}</span><span class="s2">); consider changing to a smaller type.&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;batch size = </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">; consider reducing the size of the batch you send to the attributions method.&quot;</span>
        <span class="p">]</span>

        <span class="n">doi_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="o">.</span><span class="n">cut</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="o">.</span><span class="n">cut</span><span class="p">()</span> <span class="k">else</span> <span class="n">InputCut</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">memory_suggestions</span><span class="p">(</span><span class="o">*</span><span class="n">param_msgs</span><span class="p">):</span>  <span class="c1"># Handles out-of-memory messages.</span>
            <span class="n">doi_val</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">B</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_fprop</span><span class="p">(</span>
                <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span><span class="p">,</span>
                <span class="n">to_cut</span><span class="o">=</span><span class="n">doi_cut</span><span class="p">,</span>
                <span class="n">doi_cut</span><span class="o">=</span><span class="n">InputCut</span><span class="p">(),</span>
                <span class="n">attribution_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># InputCut(),</span>
                <span class="n">intervention</span><span class="o">=</span><span class="n">model_inputs</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">doi_val</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span><span class="n">doi_val</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">as_array</span><span class="p">)</span>

        <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="o">.</span><span class="n">_wrap_public_call</span><span class="p">(</span><span class="n">doi_val</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_doi</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">interventions</span> <span class="o">=</span> <span class="n">D</span>  <span class="c1"># : Inputs[Uniform[TensorLike]]</span>

        <span class="n">D_tensors</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n_doi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">D_tensors</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">D_tensors</span><span class="p">,</span> <span class="n">MAP_CONTAINER_TYPE</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">D_tensors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">D_tensors</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">):</span>
                    <span class="n">n_doi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">D_tensors</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__concatenate_doi</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="n">rebatch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rebatch_size</span>
        <span class="k">if</span> <span class="n">rebatch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rebatch_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">intervention</span> <span class="o">=</span> <span class="n">TensorArgs</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
        <span class="n">model_inputs_expanded</span> <span class="o">=</span> <span class="n">tile</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">model_inputs</span><span class="p">,</span> <span class="n">onto</span><span class="o">=</span><span class="n">intervention</span><span class="p">)</span>
        <span class="c1"># Create a message for out-of-memory errors regarding doi_size.</span>
        <span class="c1"># TODO: Generalize this message to doi other than LinearDoI:</span>
        <span class="n">doi_size_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;distribution of interest size = </span><span class="si">{</span><span class="n">n_doi</span><span class="si">}</span><span class="s2">; consider reducing intervention resolution.&quot;</span>

        <span class="n">combined_batch_size</span> <span class="o">=</span> <span class="n">n_doi</span> <span class="o">*</span> <span class="n">batch_size</span>
        <span class="n">combined_batch_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;combined batch size = </span><span class="si">{</span><span class="n">combined_batch_size</span><span class="si">}</span><span class="s2">; consider reducing batch size, intervention size&quot;</span>

        <span class="n">rebatch_size_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rebatch_size = </span><span class="si">{</span><span class="n">rebatch_size</span><span class="si">}</span><span class="s2">; consider reducing this AttributionMethod constructor parameter (default is same as combined batch size).&quot;</span>

        <span class="c1"># Calculate the gradient of each of the points in the DoI.</span>
        <span class="k">with</span> <span class="n">memory_suggestions</span><span class="p">(</span>
                <span class="n">param_msgs</span> <span class="o">+</span>
            <span class="p">[</span><span class="n">doi_size_msg</span><span class="p">,</span> <span class="n">combined_batch_msg</span><span class="p">,</span> <span class="n">rebatch_size_msg</span><span class="p">]</span>
        <span class="p">):</span>  <span class="c1"># Handles out-of-memory messages.</span>
            <span class="n">qoi_grads_expanded</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">inputs_batch</span><span class="p">,</span> <span class="n">intervention_batch</span> <span class="ow">in</span> <span class="n">rebatch</span><span class="p">(</span>
                    <span class="n">model_inputs_expanded</span><span class="p">,</span> <span class="n">intervention</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="n">rebatch_size</span><span class="p">):</span>

                <span class="n">qoi_grads_expanded_batch</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span>
                    <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_qoi_bprop</span><span class="p">(</span>
                        <span class="n">qoi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qoi</span><span class="p">,</span>
                        <span class="n">model_inputs</span><span class="o">=</span><span class="n">inputs_batch</span><span class="p">,</span>
                        <span class="n">attribution_cut</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">from_cut</span><span class="p">,</span>
                        <span class="n">to_cut</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">to_cut</span><span class="p">,</span>
                        <span class="n">intervention</span><span class="o">=</span><span class="n">intervention_batch</span><span class="p">,</span>
                        <span class="n">doi_cut</span><span class="o">=</span><span class="n">doi_cut</span>
                    <span class="p">)</span>

                <span class="c1"># important to cast to numpy inside loop:</span>
                <span class="n">qoi_grads_expanded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">nested_map</span><span class="p">(</span><span class="n">qoi_grads_expanded_batch</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">as_array</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="n">num_outputs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qoi_grads_expanded</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">num_inputs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qoi_grads_expanded</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">transpose</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_outputs</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_outputs</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">qoi_grads_batch</span> <span class="ow">in</span> <span class="n">qoi_grads_expanded</span><span class="p">:</span>
                    <span class="n">transpose</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qoi_grads_batch</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">container_concat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Applies np concatenate on a container. If it is a map type, it will apply it on each key.</span>

<span class="sd">            Args:</span>
<span class="sd">                x (map or data container): A container of tensors</span>

<span class="sd">            Returns:</span>
<span class="sd">                concatenated tensors of the container.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">MAP_CONTAINER_TYPE</span><span class="p">):</span>
                <span class="n">ret_map</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">ret_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">_dict</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">ret_map</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">qoi_grads_expanded</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span>
            <span class="n">transpose</span><span class="p">,</span> <span class="n">container_concat</span><span class="p">,</span> <span class="n">nest</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="n">qoi_grads_expanded</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span>
            <span class="n">qoi_grads_expanded</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">grad</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="p">(</span><span class="n">n_doi</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">grad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span>
            <span class="n">nest</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_grads</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">gradients</span> <span class="o">=</span> <span class="n">qoi_grads_expanded</span>  <span class="c1"># : Outputs[Inputs[Uniform[TensorLike]]]</span>

        <span class="c1"># TODO: Does this need to be done in numpy?</span>
        <span class="n">attrs</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">[</span><span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span>
            <span class="n">qoi_grads_expanded</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">grad</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">nest</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="c1"># Multiply by the activation multiplier if specified.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_multiply</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">memory_suggestions</span><span class="p">(</span><span class="n">param_msgs</span><span class="p">):</span>
                <span class="n">z_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_fprop</span><span class="p">(</span>
                    <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span><span class="p">,</span>
                    <span class="n">doi_cut</span><span class="o">=</span><span class="n">InputCut</span><span class="p">(),</span>
                    <span class="n">attribution_cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">to_cut</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">from_cut</span><span class="p">,</span>
                    <span class="n">intervention</span><span class="o">=</span><span class="n">model_inputs</span>  <span class="c1"># intentional</span>
                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">mults</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span>
                         <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="o">.</span><span class="n">_wrap_public_get_activation_multiplier</span><span class="p">(</span>
                             <span class="n">z_val</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span>
                         <span class="p">)</span>
            <span class="n">mults</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="n">nested_cast</span><span class="p">(</span>
                <span class="n">backend</span><span class="o">=</span><span class="n">B</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">mults</span><span class="p">,</span> <span class="n">astype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
            <span class="p">)</span>
            <span class="n">mult_attrs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>  <span class="c1"># Outputs</span>

                <span class="n">zipped</span> <span class="o">=</span> <span class="n">nested_zip</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">mults</span><span class="p">)</span>

                <span class="k">def</span> <span class="nf">zip_mult</span><span class="p">(</span><span class="n">zipped_attr_mults</span><span class="p">):</span>
                    <span class="n">attr</span> <span class="o">=</span> <span class="n">zipped_attr_mults</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">mults</span> <span class="o">=</span> <span class="n">zipped_attr_mults</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">attr</span> <span class="o">*</span> <span class="n">mults</span>

                <span class="n">attr</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span>
                    <span class="n">zipped</span><span class="p">,</span> <span class="n">zip_mult</span><span class="p">,</span> <span class="n">check_accessor</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">mult_attrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="n">mult_attrs</span>
        <span class="n">results</span><span class="o">.</span><span class="n">attributions</span> <span class="o">=</span> <span class="n">attrs</span>  <span class="c1"># : Outputs[Inputs[TensorLike]]</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_qoi</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to get a `QoI` object from more user-friendly primitive </span>
<span class="sd">        arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO(klas): we could potentially do some basic error catching here,</span>
        <span class="c1">#   for example, making sure the index for a given channel is in range.</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">,</span> <span class="n">QoI</span><span class="p">):</span>
            <span class="c1"># We were already given a QoI, so return it.</span>
            <span class="k">return</span> <span class="n">qoi_arg</span>

        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">):</span>
            <span class="c1"># If we were given a callable, treat that function as a QoI.</span>
            <span class="k">return</span> <span class="n">LambdaQoI</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># If we receive an int, we take it to be the class/channel index</span>
            <span class="c1"># (whether it&#39;s a class or channel depends on the layer the quantity</span>
            <span class="c1"># is for, but `InternalChannelQoI` generalizes to both).</span>
            <span class="k">return</span> <span class="n">InternalChannelQoI</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">,</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">):</span>
            <span class="c1"># If we receive a DATA_CONTAINER_TYPE, we take it to be two classes</span>
            <span class="c1"># for which we are performing a comparative quantity of interest.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ComparativeQoI</span><span class="p">(</span><span class="o">*</span><span class="n">qoi_arg</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Tuple or list argument for `qoi` must have length 2&#39;</span>
                <span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qoi_arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># We can specify `MaxClassQoI` via the string &#39;max&#39;.</span>
            <span class="k">if</span> <span class="n">qoi_arg</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">MaxClassQoI</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;String argument for `qoi` must be one of the following:</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  - &quot;max&quot;&#39;</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unrecognized argument type for `qoi`&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_doi</span><span class="p">(</span><span class="n">doi_arg</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to get a `DoI` object from more user-friendly primitive </span>
<span class="sd">        arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doi_arg</span><span class="p">,</span> <span class="n">DoI</span><span class="p">):</span>
            <span class="c1"># We were already given a DoI, so return it.</span>
            <span class="k">return</span> <span class="n">doi_arg</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doi_arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># We can specify `PointDoi` via the string &#39;point&#39;, or `LinearDoi`</span>
            <span class="c1"># via the string &#39;linear&#39;.</span>
            <span class="k">if</span> <span class="n">doi_arg</span> <span class="o">==</span> <span class="s1">&#39;point&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">PointDoi</span><span class="p">(</span><span class="n">cut</span><span class="o">=</span><span class="n">cut</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">doi_arg</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">LinearDoi</span><span class="p">(</span><span class="n">cut</span><span class="o">=</span><span class="n">cut</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;String argument for `doi` must be one of the following:</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  - &quot;point&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  - &quot;linear&quot;&#39;</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unrecognized argument type for `doi`&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_slice</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to get a `Slice` object from more user-friendly</span>
<span class="sd">        primitive arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">,</span> <span class="n">Slice</span><span class="p">):</span>
            <span class="c1"># We are already given a Slice, so return it.</span>
            <span class="k">return</span> <span class="n">slice_arg</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">,</span> <span class="n">Cut</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span>
              <span class="nb">isinstance</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">slice_arg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
              <span class="n">slice_arg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>

            <span class="c1"># If we receive a Cut, we take it to be the Cut of the start layer.</span>
            <span class="k">return</span> <span class="n">Slice</span><span class="p">(</span><span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_cut</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">),</span> <span class="n">OutputCut</span><span class="p">())</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">,</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">):</span>
            <span class="c1"># If we receive a DATA_CONTAINER_TYPE, we take it to be the start</span>
            <span class="c1"># and end layer of the slice.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">slice_arg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Slice</span><span class="p">(</span>
                        <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_cut</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">OutputCut</span><span class="p">()</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Slice</span><span class="p">(</span>
                        <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_cut</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                        <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_cut</span><span class="p">(</span><span class="n">slice_arg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Tuple or list argument for `cuts` must have length 2&#39;</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unrecognized argument type for `cuts`&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_cut</span><span class="p">(</span><span class="n">cut_arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to get a `Cut` object from more user-friendly primitive</span>
<span class="sd">        arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cut_arg</span><span class="p">,</span> <span class="n">Cut</span><span class="p">):</span>
            <span class="c1"># We are already given a Cut, so return it.</span>
            <span class="k">return</span> <span class="n">cut_arg</span>

        <span class="k">elif</span> <span class="n">cut_arg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">cut_arg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># If we receive None or zero, we take it to be the input cut.</span>
            <span class="k">return</span> <span class="n">InputCut</span><span class="p">()</span>

        <span class="c1"># TODO(klas): may want a bit more validation here.</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cut_arg</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cut_arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Cut</span><span class="p">(</span><span class="n">cut_arg</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unrecognized argument type for cut&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__concatenate_doi</span><span class="p">(</span><span class="n">D</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]:</span>
        <span class="c1"># Returns one TensorLike for each model input.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Got empty distribution of interest. `DoI` must return at &#39;</span>
                <span class="s1">&#39;least one point.&#39;</span>
            <span class="p">)</span>
        <span class="c1"># TODO: should this always be done in numpy or can we do it in backend?</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">nested_cast</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">get_backend</span><span class="p">(),</span> <span class="n">args</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">astype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">,</span> <span class="n">nest</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.attribution.InternalInfluence.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cuts</span><span class="p">,</span> <span class="n">qoi</span><span class="p">,</span> <span class="n">doi</span><span class="p">,</span> <span class="n">multiply_activation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_grads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_doi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.attribution.InternalInfluence.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="trulens.nn.models._model_base.ModelWrapper">ModelWrapper</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model for which attributions are calculated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cuts</code></td>
          <td>
                <code><span title="trulens_explain.trulens.nn.attribution.SliceLike">SliceLike</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The slice to use when computing the attributions. The slice 
keeps track of the layer whose output attributions are 
calculated and the layer for which the quantity of interest is 
computed. Expects a <code>Slice</code> object, or a related type that can
be interpreted as a <code>Slice</code>, as documented below.</p>
<p>If a single <code>Cut</code> object is given, it is assumed to be the cut 
representing the layer for which attributions are calculated 
(i.e., <code>from_cut</code> in <code>Slice</code>) and the layer for the quantity of 
interest (i.e., <code>to_cut</code> in <code>slices.Slice</code>) is taken to be the 
output of the network. If a tuple or list of two <code>Cut</code>s is 
given, they are assumed to be <code>from_cut</code> and <code>to_cut</code>, 
respectively.</p>
<p>A cut (or the cuts within the tuple) can also be represented as 
an <code>int</code>, <code>str</code>, or <code>None</code>. If an <code>int</code> is given, it represents 
the index of a layer in <code>model</code>. If a <code>str</code> is given, it 
represents the name of a layer in <code>model</code>. <code>None</code> is an 
alternative for <code>slices.InputCut</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>qoi</code></td>
          <td>
                <code><span title="trulens_explain.trulens.nn.attribution.QoiLike">QoiLike</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Quantity of interest to attribute. Expects a <code>QoI</code> object, or a
related type that can be interpreted as a <code>QoI</code>, as documented
below.</p>
<p>If an <code>int</code> is given, the quantity of interest is taken to be 
the slice output for the class/neuron/channel specified by the 
given integer, i.e., 
<div class="highlight"><pre><span></span><code><span class="n">quantities</span><span class="o">.</span><span class="n">InternalChannelQoI</span><span class="p">(</span><span class="n">qoi</span><span class="p">)</span>
</code></pre></div></p>
<p>If a tuple or list of two integers is given, then the quantity 
of interest is taken to be the comparative quantity for the 
class given by the first integer against the class given by the 
second integer, i.e., 
<div class="highlight"><pre><span></span><code><span class="n">quantities</span><span class="o">.</span><span class="n">ComparativeQoI</span><span class="p">(</span><span class="o">*</span><span class="n">qoi</span><span class="p">)</span>
</code></pre></div></p>
<p>If a callable is given, it is interpreted as a function
representing the QoI, i.e.,
<div class="highlight"><pre><span></span><code><span class="n">quantities</span><span class="o">.</span><span class="n">LambdaQoI</span><span class="p">(</span><span class="n">qoi</span><span class="p">)</span>
</code></pre></div></p>
<p>If the string, <code>'max'</code>, is given, the quantity of interest is 
taken to be the output for the class with the maximum score, 
i.e., 
<div class="highlight"><pre><span></span><code><span class="n">quantities</span><span class="o">.</span><span class="n">MaxClassQoI</span><span class="p">()</span>
</code></pre></div></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>doi</code></td>
          <td>
                <code><span title="trulens_explain.trulens.nn.attribution.DoiLike">DoiLike</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Distribution of interest over inputs. Expects a <code>DoI</code> object, or
a related type that can be interpreted as a <code>DoI</code>, as documented
below.</p>
<p>If the string, <code>'point'</code>, is given, the distribution is taken to
be the single point passed to <code>attributions</code>, i.e., 
<div class="highlight"><pre><span></span><code><span class="n">distributions</span><span class="o">.</span><span class="n">PointDoi</span><span class="p">()</span>
</code></pre></div></p>
<p>If the string, <code>'linear'</code>, is given, the distribution is taken 
to be the linear interpolation from the zero input to the point 
passed to <code>attributions</code>, i.e., 
<div class="highlight"><pre><span></span><code><span class="n">distributions</span><span class="o">.</span><span class="n">LinearDoi</span><span class="p">()</span>
</code></pre></div></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>multiply_activation</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to multiply the gradient result by its corresponding
activation, thus converting from "<em>influence space</em>" to 
"<em>attribution space</em>."</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/attribution.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ModelWrapper</span><span class="p">,</span>
    <span class="n">cuts</span><span class="p">:</span> <span class="n">SliceLike</span><span class="p">,</span>
    <span class="n">qoi</span><span class="p">:</span> <span class="n">QoiLike</span><span class="p">,</span>
    <span class="n">doi</span><span class="p">:</span> <span class="n">DoiLike</span><span class="p">,</span>
    <span class="n">multiply_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_grads</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_doi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters:</span>
<span class="sd">        model:</span>
<span class="sd">            Model for which attributions are calculated.</span>

<span class="sd">        cuts: </span>
<span class="sd">            The slice to use when computing the attributions. The slice </span>
<span class="sd">            keeps track of the layer whose output attributions are </span>
<span class="sd">            calculated and the layer for which the quantity of interest is </span>
<span class="sd">            computed. Expects a `Slice` object, or a related type that can</span>
<span class="sd">            be interpreted as a `Slice`, as documented below.</span>

<span class="sd">            If a single `Cut` object is given, it is assumed to be the cut </span>
<span class="sd">            representing the layer for which attributions are calculated </span>
<span class="sd">            (i.e., `from_cut` in `Slice`) and the layer for the quantity of </span>
<span class="sd">            interest (i.e., `to_cut` in `slices.Slice`) is taken to be the </span>
<span class="sd">            output of the network. If a tuple or list of two `Cut`s is </span>
<span class="sd">            given, they are assumed to be `from_cut` and `to_cut`, </span>
<span class="sd">            respectively.</span>

<span class="sd">            A cut (or the cuts within the tuple) can also be represented as </span>
<span class="sd">            an `int`, `str`, or `None`. If an `int` is given, it represents </span>
<span class="sd">            the index of a layer in `model`. If a `str` is given, it </span>
<span class="sd">            represents the name of a layer in `model`. `None` is an </span>
<span class="sd">            alternative for `slices.InputCut`.</span>

<span class="sd">        qoi:</span>
<span class="sd">            Quantity of interest to attribute. Expects a `QoI` object, or a</span>
<span class="sd">            related type that can be interpreted as a `QoI`, as documented</span>
<span class="sd">            below.</span>

<span class="sd">            If an `int` is given, the quantity of interest is taken to be </span>
<span class="sd">            the slice output for the class/neuron/channel specified by the </span>
<span class="sd">            given integer, i.e., </span>
<span class="sd">            ```python</span>
<span class="sd">            quantities.InternalChannelQoI(qoi)</span>
<span class="sd">            ```</span>

<span class="sd">            If a tuple or list of two integers is given, then the quantity </span>
<span class="sd">            of interest is taken to be the comparative quantity for the </span>
<span class="sd">            class given by the first integer against the class given by the </span>
<span class="sd">            second integer, i.e., </span>
<span class="sd">            ```python</span>
<span class="sd">            quantities.ComparativeQoI(*qoi)</span>
<span class="sd">            ```</span>

<span class="sd">            If a callable is given, it is interpreted as a function</span>
<span class="sd">            representing the QoI, i.e.,</span>
<span class="sd">            ```python</span>
<span class="sd">            quantities.LambdaQoI(qoi)</span>
<span class="sd">            ```</span>

<span class="sd">            If the string, `&#39;max&#39;`, is given, the quantity of interest is </span>
<span class="sd">            taken to be the output for the class with the maximum score, </span>
<span class="sd">            i.e., </span>
<span class="sd">            ```python</span>
<span class="sd">            quantities.MaxClassQoI()</span>
<span class="sd">            ```</span>

<span class="sd">        doi:</span>
<span class="sd">            Distribution of interest over inputs. Expects a `DoI` object, or</span>
<span class="sd">            a related type that can be interpreted as a `DoI`, as documented</span>
<span class="sd">            below.</span>

<span class="sd">            If the string, `&#39;point&#39;`, is given, the distribution is taken to</span>
<span class="sd">            be the single point passed to `attributions`, i.e., </span>
<span class="sd">            ```python</span>
<span class="sd">            distributions.PointDoi()</span>
<span class="sd">            ```</span>

<span class="sd">            If the string, `&#39;linear&#39;`, is given, the distribution is taken </span>
<span class="sd">            to be the linear interpolation from the zero input to the point </span>
<span class="sd">            passed to `attributions`, i.e., </span>
<span class="sd">            ```python</span>
<span class="sd">            distributions.LinearDoi()</span>
<span class="sd">            ```</span>

<span class="sd">        multiply_activation:</span>
<span class="sd">            Whether to multiply the gradient result by its corresponding</span>
<span class="sd">            activation, thus converting from &quot;*influence space*&quot; to </span>
<span class="sd">            &quot;*attribution space*.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">slice</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_slice</span><span class="p">(</span><span class="n">cuts</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">qoi</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_qoi</span><span class="p">(</span><span class="n">qoi</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span> <span class="n">InternalInfluence</span><span class="o">.</span><span class="n">__get_doi</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">from_cut</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_do_multiply</span> <span class="o">=</span> <span class="n">multiply_activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_return_grads</span> <span class="o">=</span> <span class="n">return_grads</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_return_doi</span> <span class="o">=</span> <span class="n">return_doi</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.path", "search.share", "search.suggest", "toc.follow", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.19047be9.min.js"></script>
      
        <script src="../../../javascript/config.js"></script>
      
        <script src="../../../javascript/app.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../../javascript/tex-mml-chtml-3.0.0.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>